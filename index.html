<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2808阿雯随机点歌</title>
    <link rel="icon" href="https://img.ixintu.com/download/jpg/201912/6794302f1498ae8e0d7216f7056aae3f.jpg" type="image/jpeg">
    <link rel="shortcut icon" href="https://img.ixintu.com/download/jpg/201912/6794302f1498ae8e0d7216f7056aae3f.jpg" type="image/jpeg">
    <link rel="apple-touch-icon" href="https://img.ixintu.com/download/jpg/201912/6794302f1498ae8e0d7216f7056aae3f.jpg" type="image/jpeg">
    <link rel="mask-icon" href="https://img.ixintu.com/download/jpg/201912/6794302f1498ae8e0d7216f7056aae3f.jpg" type="image/jpeg" color="#000000">
    <meta name="msapplication-TileColor" content="#000000">
    <meta name="theme-color" content="#000000">
    <!-- Tailwind CSS v3 -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script>
        // 农历转公历功能
        // 由于农历转公历算法复杂，这里使用简化版本，实际应用中可能需要更复杂的算法
        function lunarToSolar(lunarYear, lunarMonth, lunarDay) {
            // 这里使用一个简单的映射表，仅包含参考图片中的日期
            // 实际应用中应该使用完整的农历转公历算法
            const lunarMap = {
                '10-18': '12-3'  // 农历十月十八 -> 阳历十二月三日
            };
            
            const key = `${lunarMonth}-${lunarDay}`;
            if (lunarMap[key]) {
                const [month, day] = lunarMap[key].split('-');
                return {
                    year: lunarYear,
                    month: parseInt(month),
                    day: parseInt(day)
                };
            }
            
            // 如果没有找到映射，返回原日期
            return {
                year: lunarYear,
                month: lunarMonth,
                day: lunarDay
            };
        }
        
        // 纪念日数据库
        const anniversaryDatabase = [
            // 阳历纪念日（参考图片）
            { type: 'solar', month: 11, day: 23, event: '南宁租约满一年' },
            { type: 'solar', month: 8, day: 20, event: '訸哥生日' },
            { type: 'solar', month: 8, day: 20, event: '山酒生日' },
            { type: 'solar', month: 8, day: 25, event: '道童哥生日' },
            { type: 'solar', month: 3, day: 15, event: '男孩哥生日' },
            { type: 'solar', month: 11, day: 06, event: '阿雯找歌V1发布' },
            { type: 'solar', month: 11, day: 09, event: '阿雯找歌V2发布：有搜索有历史，闽南歌改欢快歌' },
            { type: 'solar', month: 11, day: 13, event: '阿雯找歌V3发布：添加纪念日提醒' },
            
            // 农历纪念日（参考图片）
            { type: 'lunar', month: 10, day: 18, event: '阿雯生日' },
            { type: 'lunar', month: 11, day: 4, event: '清风哥生日' },
            { type: 'lunar', month: 2, day: 12, event: '奶奶生日' },
            { type: 'lunar', month: 3, day: 1, event: '姑姑生日' },
            { type: 'lunar', month: 9, day: 10, event: '爷爷生日' },
            { type: 'lunar', month: 7, day: 26, event: '二姐罗菲香生日' },
            
            // 二十四节气
            { type: 'solar', month: 2, day: 3, event: '立春 节气' },
            { type: 'solar', month: 2, day: 18, event: '雨水 节气' },
            { type: 'solar', month: 3, day: 5, event: '惊蛰 节气' },
            { type: 'solar', month: 3, day: 20, event: '春分 节气' },
            { type: 'solar', month: 4, day: 4, event: '清明 节气' },
            { type: 'solar', month: 4, day: 20, event: '谷雨 节气' },
            { type: 'solar', month: 5, day: 5, event: '立夏 节气' },
            { type: 'solar', month: 5, day: 21, event: '小满 节气' },
            { type: 'solar', month: 6, day: 5, event: '芒种 节气' },
            { type: 'solar', month: 6, day: 21, event: '夏至 节气' },
            { type: 'solar', month: 7, day: 7, event: '小暑 节气' },
            { type: 'solar', month: 7, day: 22, event: '大暑 节气' },
            { type: 'solar', month: 8, day: 7, event: '立秋 节气' },
            { type: 'solar', month: 8, day: 23, event: '处暑 节气' },
            { type: 'solar', month: 9, day: 7, event: '白露 节气' },
            { type: 'solar', month: 9, day: 23, event: '秋分 节气' },
            { type: 'solar', month: 10, day: 8, event: '寒露 节气' },
            { type: 'solar', month: 10, day: 23, event: '霜降 节气' },
            { type: 'solar', month: 11, day: 7, event: '立冬 节气' },
            { type: 'solar', month: 11, day: 22, event: '小雪 节气' },
            { type: 'solar', month: 12, day: 7, event: '大雪 节气' },
            { type: 'solar', month: 12, day: 21, event: '冬至 节气' },
            { type: 'solar', month: 1, day: 5, event: '小寒 节气' },
            { type: 'solar', month: 1, day: 20, event: '大寒 节气' },
            
            // 通用节日
            { type: 'solar', month: 12, day: 31, event: '跨年' },
            { type: 'solar', month: 1, day: 1, event: '元旦' },
            { type: 'solar', month: 2, day: 14, event: '情人节' },
            { type: 'solar', month: 3, day: 8, event: '妇女节' },
            { type: 'solar', month: 3, day: 12, event: '植树节' },
            { type: 'solar', month: 4, day: 1, event: '愚人节' },
            { type: 'solar', month: 5, day: 1, event: '劳动节' },
            { type: 'solar', month: 5, day: 4, event: '青年节' },
            { type: 'solar', month: 6, day: 1, event: '儿童节' },
            { type: 'solar', month: 7, day: 1, event: '建党节' },
            { type: 'solar', month: 8, day: 1, event: '建军节' },
            { type: 'solar', month: 9, day: 10, event: '教师节' },
            { type: 'solar', month: 10, day: 1, event: '国庆节' },
            { type: 'solar', month: 12, day: 25, event: '圣诞节' },
            
            // 传统节日
            { type: 'lunar', month: 1, day: 1, event: '春节' },
            { type: 'lunar', month: 1, day: 15, event: '元宵节' },
            { type: 'lunar', month: 5, day: 5, event: '端午节' },
            { type: 'lunar', month: 7, day: 7, event: '七夕节' },
            { type: 'lunar', month: 8, day: 15, event: '中秋节' },
            { type: 'lunar', month: 9, day: 9, event: '重阳节' },
            { type: 'lunar', month: 12, day: 8, event: '腊八节' },
            { type: 'lunar', month: 12, day: 30, event: '除夕' }
        ];
        
        // 主题颜色配置
        const themeColors = {
            red: {
                primary: '#e53e3e',
                secondary: '#3182ce',
                accent: '#f6e05e',
                dark: '#2d3748',
                light: '#f7fafc'
            },
            blue: {
                primary: '#3182ce',
                secondary: '#e53e3e',
                accent: '#f6e05e',
                dark: '#2d3748',
                light: '#f7fafc'
            },
            green: {
                primary: '#38a169',
                secondary: '#3182ce',
                accent: '#f6e05e',
                dark: '#2d3748',
                light: '#f7fafc'
            },
            purple: {
                primary: '#805ad5',
                secondary: '#3182ce',
                accent: '#f6e05e',
                dark: '#2d3748',
                light: '#f7fafc'
            },
            orange: {
                primary: '#dd6b20',
                secondary: '#3182ce',
                accent: '#f6e05e',
                dark: '#2d3748',
                light: '#f7fafc'
            }
        };
        
        // 深色模式颜色配置
        const darkThemeColors = {
            red: {
                primary: '#e53e3e',
                secondary: '#3182ce',
                accent: '#f6e05e',
                dark: '#1a202c',
                light: '#2d3748'
            },
            blue: {
                primary: '#3182ce',
                secondary: '#e53e3e',
                accent: '#f6e05e',
                dark: '#1a202c',
                light: '#2d3748'
            },
            green: {
                primary: '#38a169',
                secondary: '#3182ce',
                accent: '#f6e05e',
                dark: '#1a202c',
                light: '#2d3748'
            },
            purple: {
                primary: '#805ad5',
                secondary: '#3182ce',
                accent: '#f6e05e',
                dark: '#1a202c',
                light: '#2d3748'
            },
            orange: {
                primary: '#dd6b20',
                secondary: '#3182ce',
                accent: '#f6e05e',
                dark: '#1a202c',
                light: '#2d3748'
            }
        };
        
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#e53e3e',
                        secondary: '#3182ce',
                        accent: '#f6e05e',
                        dark: '#2d3748',
                        light: '#f7fafc'
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    },
                    animation: {
                        'bounce-slow': 'bounce 2s infinite',
                    }
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        :root {
            --primary-color: #e53e3e;
            --secondary-color: #3182ce;
            --accent-color: #f6e05e;
            --dark-color: #2d3748;
            --light-color: #f7fafc;
            --base-size: 0.8; /* 基础大小系数，用于控制整体界面大小 */
            --bg-brightness: 1; /* 背景亮度 */
            --bg-contrast: 1; /* 背景对比度 */
            --bg-opacity: 0.8; /* 背景透明度 */
            font-size: calc(16px * var(--base-size)); /* 设置基础字体大小 */
        }
        
        body {
            /* 背景图片设置 - 降低可视化效果 */
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            background-repeat: no-repeat;
            position: relative;
        }
        
        /* 使用伪元素实现背景图片模糊效果 */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('https://img.ixintu.com/download/jpg/201912/6794302f1498ae8e0d7216f7056aae3f.jpg');
            background-color: rgba(255, 255, 255, var(--bg-opacity));
            background-blend-mode: overlay;
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            background-repeat: no-repeat;
            /* 添加模糊效果 */
            filter: blur(4px) brightness(var(--bg-brightness)) contrast(var(--bg-contrast));
            -webkit-filter: blur(4px) brightness(var(--bg-brightness)) contrast(var(--bg-contrast));
            /* 放大一点以避免边缘露白 */
            transform: scale(1.05);
            z-index: -1;
        }
        
        @layer utilities {
            .text-shadow {
                text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            }
            .btn-pop {
                @apply transform transition-transform duration-200 hover:scale-105 active:scale-95;
            }
            .song-card {
                @apply bg-white rounded-lg shadow-md p-4 flex justify-between items-center mb-3 transition-all duration-300 hover:shadow-lg;
            }
            /* 基于基础大小的间距工具类 */
            .gap-xs { gap: calc(0.25rem * var(--base-size)); }
            .gap-sm { gap: calc(0.5rem * var(--base-size)); }
            .gap-md { gap: calc(0.75rem * var(--base-size)); }
            .gap-lg { gap: calc(1rem * var(--base-size)); }
            .gap-xl { gap: calc(1.25rem * var(--base-size)); }
            /* 基于基础大小的内边距工具类 */
            .p-xs { padding: calc(0.25rem * var(--base-size)); }
            .p-sm { padding: calc(0.5rem * var(--base-size)); }
            .p-md { padding: calc(0.75rem * var(--base-size)); }
            .p-lg { padding: calc(1rem * var(--base-size)); }
            .p-xl { padding: calc(1.25rem * var(--base-size)); }
            /* 基于基础大小的外边距工具类 */
            .m-xs { margin: calc(0.25rem * var(--base-size)); }
            .m-sm { margin: calc(0.5rem * var(--base-size)); }
            .m-md { margin: calc(0.75rem * var(--base-size)); }
            .m-lg { margin: calc(1rem * var(--base-size)); }
            .m-xl { margin: calc(1.25rem * var(--base-size)); }
            /* 基于基础大小的圆角工具类 */
            .rounded-xs { border-radius: calc(0.125rem * var(--base-size)); }
            .rounded-sm { border-radius: calc(0.25rem * var(--base-size)); }
            .rounded-md { border-radius: calc(0.375rem * var(--base-size)); }
            .rounded-lg { border-radius: calc(0.5rem * var(--base-size)); }
            .rounded-xl { border-radius: calc(0.75rem * var(--base-size)); }
            /* 基于基础大小的高度工具类 */
            .h-xs { height: calc(1rem * var(--base-size)); }
            .h-sm { height: calc(1.5rem * var(--base-size)); }
            .h-md { height: calc(2rem * var(--base-size)); }
            .h-lg { height: calc(2.5rem * var(--base-size)); }
            .h-xl { height: calc(3rem * var(--base-size)); }
            /* 基于基础大小的宽度工具类 */
            .w-xs { width: calc(1rem * var(--base-size)); }
            .w-sm { width: calc(1.5rem * var(--base-size)); }
            .w-md { width: calc(2rem * var(--base-size)); }
            .w-lg { width: calc(2.5rem * var(--base-size)); }
            .w-xl { width: calc(3rem * var(--base-size)); }
            /* 基于基础大小的字体大小工具类 */
            .text-xs { font-size: calc(0.75rem * var(--base-size)); }
            .text-sm { font-size: calc(0.875rem * var(--base-size)); }
            .text-md { font-size: calc(1rem * var(--base-size)); }
            .text-lg { font-size: calc(1.125rem * var(--base-size)); }
            .text-xl { font-size: calc(1.25rem * var(--base-size)); }
            .text-2xl { font-size: calc(1.5rem * var(--base-size)); }
            .text-3xl { font-size: calc(1.875rem * var(--base-size)); }
            .text-4xl { font-size: calc(2.25rem * var(--base-size)); }
            .text-5xl { font-size: calc(3rem * var(--base-size)); }
        }
        
        /* 确保主题设置面板在深色模式下也有良好的显示 */
        #themeSettings {
            background-color: rgba(0, 0, 0, 0.5);
        }
        
        #settingsPanel {
            background-color: var(--light-color);
            color: var(--dark-color);
        }
        
        /* 确保通知在深色模式下也有良好的显示 */
        .fixed.bottom-4.right-4 {
            color: white;
        }
        
        /* 历史记录歌曲名和时间戳的样式 */
        .history-song-name {
            color: #2d3748; /* text-gray-800 */
        }
        
        .history-song-time {
            color: #718096; /* text-gray-500 */
        }
        
        /* 深色模式下历史记录歌曲名和时间戳的样式 */
        .dark .history-song-name,
        .dark .history-song-time {
            color: #cbd5e1 !important; /* text-gray-300 */
        }
        
        /* 自动滚动歌单区域样式 */
        #scrollContainer {
            overflow: hidden;
            position: relative;
        }
        
        #songScrollList {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
        }
        
        .scroll-song-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid transparent;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            height: 32px; /* 固定高度，确保每行高度一致 */
        }
        
        /* 飞入特效动画 - 从右到左，效果更明显 */
        @keyframes scrollFlyIn {
            0% {
                transform: translateX(100%);
                opacity: 0;
            }
            100% {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        /* 飞入特效类 - 效果更明显，持续时间更长 */
        .scroll-fly-in {
            animation: scrollFlyIn 1s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards !important;
            z-index: 10; /* 确保动画元素在最上层 */
        }
        
        /* 初始状态下需要动画的歌曲 */
        .scroll-song-animated {
            opacity: 0; /* 初始状态设为不可见 */
            transform: translateX(100%);
            transition: none; /* 确保没有过渡效果干扰动画 */
        }
        
        /* 隐藏歌曲 - 字体颜色与背景相同 */
        .scroll-song-hidden {
            color: transparent !important;
            background-color: transparent !important;
            user-select: none;
            border: none;
            cursor: default;
        }
        
        /* 隐藏歌曲的子元素也需要隐藏 */
        .scroll-song-hidden .scroll-song-name,
        .scroll-song-hidden .scroll-copy-btn {
            color: transparent !important;
            background-color: transparent !important;
            user-select: none;
            border: none;
            cursor: default;
        }
        
        .scroll-song-item:last-child {
            border-bottom: none;
        }
        
        .scroll-song-name {
            flex: 1;
            overflow: hidden;
            text-overflow: ellipsis;
            margin-left: 10px; /* 添加左侧margin */
        }
        
        .scroll-copy-btn {
            opacity: 0.7;
            transition: opacity 0.2s ease;
        }
        
        .scroll-song-item:hover .scroll-copy-btn {
            opacity: 1;
        }
        
        /* 深色模式下滚动歌单样式 */
        .dark #scrollContainer {
            background-color: transparent;
        }
        
        .dark .scroll-song-item {
            color: #cbd5e1;
            border-bottom-color: rgba(55, 65, 81, 0.5);
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-purple-50 min-h-screen">
    <div class="container mx-auto px-4 py-8 max-w-2xl">
        <!-- 标题区域 -->
        <div class="text-center mb-xl relative">
            <button id="settingsBtn" class="absolute right-0 top-1/2 transform -translate-y-1/2 bg-gray-200 hover:bg-gray-300 text-gray-700 p-2 rounded-full shadow transition-all duration-200 hover:shadow-md">
                <i class="fa fa-cog text-xl"></i>
            </button>
            <h1 class="text-4xl md:text-5xl font-bold text-primary mb-2 text-shadow animate-bounce-slow">2808阿雯找歌V3</h1>
            <p class="text-xl md:text-2xl text-secondary font-medium">山酒制作2025-11-12</p>
        </div>
        
        <!-- 主要按钮区域 -->
        <div class="flex justify-center gap-md mb-8">
            <button id="randomBtn" class="bg-primary hover:bg-red-600 text-white font-bold py-3 px-8 rounded-full shadow-lg btn-pop flex items-center">
                <i class="fa fa-random mr-2"></i> 随机
            </button>
            <button id="recentBtn" class="bg-secondary hover:bg-blue-600 text-white font-bold py-3 px-8 rounded-full shadow-lg btn-pop flex items-center">
                <i class="fa fa-clock-o mr-2"></i> 最近学会
            </button>
        </div>
        
        <!-- 分类按钮区域 -->
        <div class="flex flex-wrap justify-center gap-sm mb-xl">
            <button id="ancientBtn" class="bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-5 rounded-full shadow-md btn-pop text-sm flex items-center">
                <i class="fa fa-book mr-1"></i> 古风歌
            </button>
            <button id="popBtn" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-5 rounded-full shadow-md btn-pop text-sm flex items-center">
                <i class="fa fa-music mr-1"></i> 欢快
            </button>
            <button id="grasslandBtn" class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-5 rounded-full shadow-md btn-pop text-sm flex items-center">
                <i class="fa fa-tree mr-1"></i> 草原歌
            </button>
            <button id="highNoteBtn" class="bg-orange-500 hover:bg-orange-600 text-white font-bold py-2 px-5 rounded-full shadow-md btn-pop text-sm flex items-center">
                <i class="fa fa-volume-up mr-1"></i> 高音歌
            </button>
            <button id="cantoneseBtn" class="bg-red-700 hover:bg-red-800 text-white font-bold py-2 px-5 rounded-full shadow-md btn-pop text-sm flex items-center">
                <i class="fa fa-globe mr-1"></i> 粤语歌
            </button>
        </div>

        <!-- 歌曲显示区域 -->
        <div id="songContainer" class="mb-8 space-y-3">
            <!-- 歌曲将通过JavaScript动态添加 -->
            <div class="text-center text-gray-400 italic text-sm">
                <i class="fa fa-info-circle mr-1"></i> 点击上方按钮开始点歌
            </div>
        </div>

        <!-- 历史记录区域 -->
        <div class="mb-8">
            <div class="flex items-center justify-between items-center mb-3">
                <h2 class="text-xl font-bold text-gray-800 flex items-center">
                    <i class="fa fa-history text-primary mr-2"></i> 点歌历史
                    <span id="historyBadge" class="ml-2 bg-primary text-white text-xs px-2 py-1 rounded-full">0</span>
                </h2>
                <div class="flex gap-2">
                    <button id="toggleHistoryBtn" class="bg-gray-200 hover:bg-gray-300 text-dark font-medium py-1 px-3 rounded-full text-sm flex items-center">
                        <i class="fa fa-chevron-down mr-1"></i> 查看
                    </button>
                </div>
            </div>
            <div id="historyContainer" class="bg-white rounded-lg shadow-md p-4 hidden max-h-80 overflow-y-auto">
                <div id="historyList" class="divide-y divide-gray-100">
                    <!-- 历史记录将通过JavaScript动态添加 -->
                    <div class="text-center text-gray-500 py-4">暂无历史记录</div>
                </div>
            </div>
        </div>
        

        
        <!-- 自动滚动歌单区域 -->
        <div class="my-8">
            <div class="flex items-center justify-between items-center mb-2">
                <h2 class="text-xl font-bold text-gray-800 flex items-center">
                    <i class="fa fa-music text-primary mr-2"></i> 2808阿雯歌单
                </h2>
                <div class="text-sm text-gray-500">
                    <i class="fa fa-info-circle mr-1"></i> 鼠标悬停可暂停/滑轮可滚动
                </div>
            </div>
            <div id="scrollContainer" class="relative bg-transparent rounded-lg shadow-md p-md overflow-hidden" style="height: calc(224px * var(--base-size));">
                <div id="songScrollList" class="absolute top-0 left-0 right-0">
                    <!-- 歌曲列表将通过JavaScript动态添加 -->
                </div>
            </div>
        </div>
        
        <!-- 搜索区域 -->
        <div class="mb-8 relative">
            <div class="relative">
                <input 
                    type="text" 
                    id="searchInput" 
                    placeholder="搜索歌曲..." 
                    class="w-full py-3 px-5 pr-12 rounded-full border border-gray-300 bg-transparent backdrop-blur-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent shadow-sm transition-all duration-300"
                >
                <button id="searchBtn" class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-primary transition-colors duration-200">
                    <i class="fa fa-search text-xl"></i>
                </button>
                <button id="clearSearchBtn" class="absolute right-10 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 transition-colors duration-200 hidden">
                    <i class="fa fa-times-circle text-xl"></i>
                </button>
            </div>
            <!-- 搜索结果区域 -->
            <div id="searchResults" class="absolute left-0 right-0 mt-2 bg-transparent backdrop-blur-sm rounded-lg shadow-lg overflow-hidden z-50 max-h-96 overflow-y-auto hidden">
        </div>
        
        <!-- 时间显示区域 -->
        <div class="mt-8 pt-4 border-t border-gray-200 text-center text-sm text-gray-600">
            <div id="startTime" class="mb-1">开播时间：加载中...</div>
            <div id="currentTime" class="mb-1">目前时间：加载中...</div>
            <div id="elapsedTime" class="font-medium">开播累计时间：加载中...</div>
        </div>
        
        <!-- 主题设置面板 -->
        <div id="themeSettings" class="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center hidden">
            <div class="bg-white rounded-lg shadow-xl p-lg max-w-md w-full mx-4 transform transition-all duration-300 scale-95 opacity-0" id="settingsPanel">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-bold text-gray-800">主题设置</h3>
                    <button id="closeSettingsBtn" class="text-gray-500 hover:text-gray-700 transition-colors duration-200">
                        <i class="fa fa-times text-xl"></i>
                    </button>
                </div>
                
                <div class="mb-6">
                    <h4 class="font-medium text-gray-700 mb-3">主题模式</h4>
                    <div class="flex gap-4">
                        <button id="lightThemeBtn" class="flex-1 py-2 px-4 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors duration-200 flex items-center justify-center">
                            <i class="fa fa-sun-o text-yellow-500 mr-2"></i> 浅色
                        </button>
                        <button id="darkThemeBtn" class="flex-1 py-2 px-4 bg-gray-800 text-white hover:bg-gray-700 rounded-lg transition-colors duration-200 flex items-center justify-center">
                            <i class="fa fa-moon-o text-blue-300 mr-2"></i> 深色
                        </button>
                    </div>
                </div>
                
                <div class="mb-6">
                    <h4 class="font-medium text-gray-700 mb-3">主题颜色</h4>
                    <div class="grid grid-cols-5 gap-sm">
                        <button class="color-option w-full h-10 rounded-full bg-red-500" data-color="red"></button>
                        <button class="color-option w-full h-10 rounded-full bg-blue-500" data-color="blue"></button>
                        <button class="color-option w-full h-10 rounded-full bg-green-500" data-color="green"></button>
                        <button class="color-option w-full h-10 rounded-full bg-purple-500" data-color="purple"></button>
                        <button class="color-option w-full h-10 rounded-full bg-orange-500" data-color="orange"></button>
                    </div>
                </div>
                
                <div class="mb-6">
                    <h4 class="font-medium text-gray-700 mb-3">界面大小</h4>
                    <div class="grid grid-cols-4 gap-sm">
                        <button id="sizeTinyBtn" class="py-2 px-4 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors duration-200 flex items-center justify-center">
                            <i class="fa fa-minus mr-2"></i> 极小
                        </button>
                        <button id="sizeSmallBtn" class="py-2 px-4 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors duration-200 flex items-center justify-center">
                            <i class="fa fa-compress mr-2"></i> 小
                        </button>
                        <button id="sizeMediumBtn" class="py-2 px-4 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors duration-200 flex items-center justify-center">
                            <i class="fa fa-square mr-2"></i> 中
                        </button>
                        <button id="sizeLargeBtn" class="py-2 px-4 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors duration-200 flex items-center justify-center">
                            <i class="fa fa-expand mr-2"></i> 大
                        </button>
                    </div>
                </div>
                
                <div class="mb-6">
                    <h4 class="font-medium text-gray-700 mb-3">滚动歌单速度</h4>
                    <div class="grid grid-cols-3 gap-sm">
                        <button id="speedSlowBtn" class="py-2 px-4 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors duration-200 flex items-center justify-center">
                            <i class="fa fa-clock-o mr-2"></i> 慢
                        </button>
                        <button id="speedMediumBtn" class="py-2 px-4 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors duration-200 flex items-center justify-center ring-2 ring-primary">
                            <i class="fa fa-bolt mr-2"></i> 中
                        </button>
                        <button id="speedFastBtn" class="py-2 px-4 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors duration-200 flex items-center justify-center">
                            <i class="fa fa-rocket mr-2"></i> 快
                        </button>
                    </div>
                </div>
                
                <div class="flex justify-end">
                    <button id="resetThemeBtn" class="bg-gray-200 hover:bg-gray-300 text-gray-700 py-2 px-4 rounded-lg mr-3 transition-colors duration-200">
                        恢复默认
                    </button>
                    <button id="saveThemeBtn" class="bg-primary hover:bg-red-600 text-white py-2 px-4 rounded-lg transition-colors duration-200">
                        保存设置
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 歌曲数据库
        const songDatabase = {
            all: [
                "9420", "38度6", "AINY", "Dear John", "Faded", "I Miss You", "Letting Go", 
                "LOVE LOVE", "LOVE LOVE LOVE", "New Boy", "あいしてる我爱你", "阿刁", "阿尔山", 
                "阿尔山的姑娘", "哎", "哎呀呀", "爱不在就放手", "爱到尽头也无悔", "爱的供养", "爱的华尔兹", 
                "爱过了也伤过了", "爱河", "爱就爱了", "爱美无罪", "爱你", "爱你一百岁", "爱情错觉", "爱情小丑", 
                "爱情一阵风", "爱情主演", "爱情专属权", "爱囚", "爱如星火", "爱上你是一个错", "爱似水仙", 
                "爱我的人和我爱的人", "爱我就跟我走", "爱一点", "八号当铺", "把握你的美", "白鸽", "白狐", 
                "白月光与朱砂痣", "百花香", "百万个吻", "半壶纱", "宝贝宝贝", "悲伤已成曲", "北京烟火", "备爱", 
                "被爱融化的雪", "被驯服的象", "变色的蝴蝶", "别错过", "别丢下我不管", "别想他", "别找我麻烦", 
                "别知己", "伯虎说", "卜卦", "不必在乎我是谁", "不过人间", "不仅仅是喜欢", "不配怀念", "不配说爱我", 
                "不舍", "不是因为寂寞才想你", "不挽留没回头", "不谓侠", "不想", "不想今生失去你", "不想让你知道", 
                "不要见不要贱", "不要停", "不要忘记我爱你", "不知所措", "彩色的黑", "彩云之南", "残雪", "侧脸", 
                "曾经最美", "唱着情歌流着泪", "朝圣者", "吃货进行曲", "宠爱吖", "宠坏", "丑八怪", "传奇", "闯天涯", 
                "春三月", "蠢货", "刺", "匆匆那年", "从来不在乎", "从前说", "寸草心", "错过的情人", "错位时空", 
                "嗒嘀嗒", "大海", "大浪淘沙", "大叔不要跑", "大天蓬", "大田后生仔", "大鱼", "大雨还在下", 
                "带我到山顶", "单身情歌", "当爱情离开的时候", "当爱在靠近", "当你", "倒数", "盗心贼", "地铁等待", 
                "地铁上的陌生人", "登上舞台", "等一个人", "帝都", "第一次爱的人", "点歌的人", "电台情歌", "丁香花", 
                "东北偏北的地方", "东西", "冬眠", "冬天的秘密", "都说", "嘟嘟嘟", "独家记忆", "渡红尘", "断了乱了", 
                "对你说", "多年以后", "多情种", "多想留在你身边", "繁星点点", "犯错", "房间", "飞蛾扑火", "飞鸟和蝉", 
                "飞鸟与射手", "分开那天", "风吹麦浪", "风一样的人", "风筝误", "风中有朵雨做的云", "芙蓉雨", "父亲写的散文诗", 
                "该", "感官先生", "感谢你曾经来过", "干就得了", "干物女", "高原蓝", "歌在飞", "给电影人的情书", "跟我约会吧", 
                "咕叽咕叽", "孤单坠爱", "孤独颂歌", "孤芳自赏", "姑娘爱情郎", "光", "光辉岁月(国语版)", "光明", "光年之外", 
                "光阴的故事", "广寒宫", "过火", "过客", "海鸥飞", "好可惜", "好想好想", "好运来", "荷塘月色", 
                "黑白照", "很任性", "恨你爱我又放手", "红尘情歌", "红豆", "红色的高跟鞋", "红山果", "红颜旧", "红昭愿", 
                "后来", "后来我去北京找过你", "后来遇见他", "忽然好想念", "胡广生", "蝴蝶不流泪", "蝴蝶泉边", "花海", 
                "花木兰", "花桥流水", "画", "画颜", "皇上吉祥", "黄昏晓", "黄梅戏", "灰色地带", "回忆那么伤", "回忆总想哭", 
                "活着", "火红的萨日朗", "火火的姑娘", "即兴", "记事本", "寂寞的双手", "寂寞太迟", "寂寞在唱歌", "嘉宾", 
                "江南夜色", "江上晚风吟", "讲不出再见", "讲真的", "姐就是女王", "借", "今生爱的就是你", "今生不想失去你", 
                "今天你要嫁给我", "今夜你又不回来", "尽头", "锦鲤抄", "进退两难", "静悄悄", "九张机", "酒梦", "酒醉的蝴蝶", 
                "菊花爆满山", "诀爱", "开始懂了", "堪培拉的风", "康美之恋", "可不可以", "可可托海的牧羊人", "空山新雨后", 
                "空心", "口是心非", "哭泣的玫瑰", "宽容", "来迟", "来生愿做一朵莲", "来自天堂的魔鬼", "浪漫爱", "浪子闲话", 
                "泪满天", "离岸", "离别两依依", "离人愁", "离人殇", "练习题", "恋人心", "两个我们", "淋雨一直走", "灵灵", 
                "流浪", "流泪", "流着泪说分手", "六六顺", "路灯下的小姑娘", "罗曼蒂克的爱情", "落叶的秋", "落雨的秋", "妈妈的话", 
                "玛尼情歌", "漫步人生路", "没了心的爱", "没什么不同", "没有你陪伴真的好孤单", "没有什么不同", "梅花弄弄弄", 
                "孟婆的碗", "梦草原", "梦的翅膀受了伤", "梦回云南", "梦魔", "梦醒时分", "梦魇", "明天你好", "魔鬼中的天使", 
                "莫问归期", "默", "拿着青春陪你赌", "那个年代", "那个人", "那么骄傲", "那女孩对我说", "你爱我坏", "你不懂", 
                "你曾对天发过誓", "你的承诺", "你的过去我不介意", "你的酒馆对我打了烊", "你的万水千山", "你的眼神", "你对我太重要", 
                "你好不好", "你没错", "你若三冬", "你傻不傻", "你是我的罗密欧", "你是我的玫瑰花", "你是我的妞", "你是我戒不掉的烟", 
                "你笑起来真好看", "你一定要幸福", "你在他乡还好吗", "你怎么舍得我难过", "你走", "逆境重生", "逆流成河", "逆战", 
                "牛在飞", "暖暖", "女儿情", "欧若拉", "陪你一起变老", "片片相思赋予谁", "骗情骗爱", "漂洋过海来看你", "平凡之路", 
                "平行恋人", "七里香", "旗开得胜", "起风了", "恰似你的温柔", "千年等一回", "牵丝戏", "前度", "亲爱的那不是爱情", 
                "青藏高原", "清明上河图", "情花", "情话", "情火", "情人鹤顶红", "情人迷", "情深几许", "情深深雨蒙蒙", "请先说你好", 
                "秋天不回来", "秋天的思念", "全世界谁倾听你", "全是爱", "缺少一个你", "燃烧爱", "让全世界知道我爱你", "热气球", 
                "人的命天注定", "人间烟火", "人世间", "人走爱未凉", "容易受伤的女人", "如果爱下去", "如果寂寞了", "如愿", "入戏太深", 
                "若把你", "三生三幸", "三十出头", "三月里的小雨", "沙漠骆驼", "伤疤还没好就忘了疼", "伤河", "伤心城市", "伤心的酒吧", 
                "伤心的泪", "殇雪", "烧酒话", "少年", "奢香夫人", "谁在意我流下的泪", "深夜地下铁", "神度", "沈园外", "生活倒影", 
                "剩女的诱惑", "失宠", "失恋恋阵线联盟", "失眠", "失去爱的的城市", "十一年", "时光洪流", "时间长了受不了", "世间美好与你环环相扣", 
                "世界这么大还是遇见你", "是否爱过", "是你", "瞬间", "说散就散", "说说话", "思念成沙", "撕夜", "死了都要爱", "死皮赖脸", 
                "死心塌地去爱你", "送亲", "酸酸甜甜就是我", "她来听我的演唱会", "太想念", "太阳", "叹", "唐古拉", "逃爱", "逃之夭夭", 
                "桃花运", "套马杆", "体面", "天黑了你还记得我吗", "天后", "天籁之爱", "天亮了", "天亮以前说再见", "天使的翅膀", "天涯", 
                "天在下雨我在想你", "甜了个蜜", "甜蜜蜜", "听闻远方有你", "童年", "外婆桥", "晚风1997", "忘尘谷", "微风细雨", "微微", 
                "为爱痴狂", "为你而痛", "为情所伤", "喂猪", "温柔乡", "温柔与霸道", "吻爱", "吻安", "吻得太逼真", "问", "问莲", "问情", 
                "我爱的人和爱我的人", "我爱你", "我从草原来", "我的唇吻不到我爱的人", "我的楼兰", "我的梦", "我的秘密", "我的世界", 
                "我的心", "我的心好冷", "我的眼泪不为你说谎", "我和我的小伙伴们都惊呆了", "我很快乐", "我可以抱你吗", "我们不一样", 
                "我们的爱", "我热情如火你冰冻成河", "我是你的格桑花", "我太笨", "我相信", "我想", "我想对你说", "我想对你说baby", 
                "我要的飞翔", "我要你", "我要陪你变老", "我要我们在一起", "我要找到你", "我愿意平凡的陪在你身旁", "我在北京你在哪", 
                "我在春天等你", "我在神经什么", "我这一生", "舞女泪", "西海情歌", "西楼别序", "喜欢你", "下山", "仙人掌的忧伤", 
                "纤夫的爱", "闲庭絮", "相爱分开都是罪", "相见恨晚", "相思", "相思成灾", "相思的债", "想不想能不能该不该", "想起", 
                "想起了你", "像雾像雨又像风", "像鱼", "嚣张", "小爱", "小宝贝", "小苹果", "小薇", "小小的太阳", "小小新娘花", "小永远", 
                "笑纳", "邂逅", "心安理得", "心乱乱", "新的心跳", "新贵妃醉酒", "新少女祈祷", "新送情郎", "信仰", "星星照亮回家的路", 
                "星语心愿", "醒不来的梦", "羞答答的玫瑰静悄悄地开", "许多年以后", "寻水的鱼", "哑巴新娘", "烟火里的尘埃", "烟雨人间", 
                "言不由衷", "眼泪的错觉", "燕无歇", "要爱你就来", "野花", "野花香", "夜空中最亮的星", "夜夜夜漫长", "夜之光", 
                "一百万个可能", "一个人", "一个人的精彩", "一个人挺好", "一个人走", "一开始说陪你到老的人现在他还在吗", "一路生花", 
                "一路向北", "一起吹过晚风的街", "一生回味一面", "一生有你", "一生与你擦肩而过", "一万个舍不得", "一物降一物", "一直很安静", 
                "疑心病", "以后的以后", "易燃易爆炸", "因为爱着你", "因为你爱上他", "隐形的翅膀", "婴儿", "樱花草", "樱树花", "影帝", 
                "永不失联的爱", "勇气", "友情多余暧昧未够", "有点甜", "有何不可", "有些爱情放不下", "淤青", "余情", "余情未了", "鱼", 
                "虞兮叹", "与爱共舞", "雨爱", "雨蝶", "雨花石", "预谋", "欲言又止", "遇", "缘分一道桥", "缘为冰", "愿你", "月半小夜曲", 
                "月亮代表我的心", "月亮之伤", "月牙湾", "云朵", "云朵上的梦", "云与海", "再见", "再见只是陌生人", "在梦中", "在深秋", 
                "在他乡", "在我流泪的时候别说爱我", "在最美的时光遇见你", "责无旁贷", "怎么了", "怎么说我不爱你", "怎叹", "扎心", 
                "战争世界", "站着等你三千年", "站着坐着都想你", "谪仙", "这就是爱吗", "着魔", "真的不容易", "真情换真心", "真心爱你", 
                "真心换真情", "争什么争", "知否知否", "只若初见", "只是太爱你", "只要平凡", "纸包不住火", "至少还有你", "重要的事情要说三遍", 
                "朱丽叶的秋天", "朱砂泪", "追光者", "追梦赤子心", "追梦人", "子时过", "紫", "自从有了你", "走过咖啡屋", "走江南", "走了就别后悔", 
                "走在冷风中", "走着走着就散了", "嘴巴嘟嘟", "最初的温柔", "最孤独的人", "最后的约定", "最后我们没在一起", "最后一次", 
                "最后这一次", "最近", "最美的期待", "最美的情缘", "最美的伤口", "最亲的人", "最熟悉的陌生人", "最幸福的人", "最远的你是我最近的爱", 
                "醉千年", "作曲家", "坐上火车去拉萨", "做你心上的人", "爱拼才会赢", "彼岸", "骗我", "贴水浮莲", "奔赴星空", "外愈", "刀马旦", "你的千山万水", 
                "去年夏天", "不染", "独角戏", "此情一直在心间", "请不要对我说Sorry", "你都对我不对", "生日礼物", "痴情冢", "厚颜无耻", 
                "后海酒吧", "被爱融化的雪", "故事还长", "星辰大海", "客官不可以", "筝语", "他他他", "火苗", "你走吧", "野子", "相见非欢", 
                "小野猫", "早安隆回", "不爱又何必纠缠", "童话镇", "荒漠", "善变", "兰花草", "辞九门回忆", "叹云兮", "泡沫", "旧梦", "失控", 
                "最后的人", "忘了", "如果爱忘了", "是妈妈是女儿", "真的爱着你", "阿拉斯加海湾", "可能", "三月三", "难却", "九儿", "放过自己", 
                "姑娘在远方", "寄长月", "春泥", "余香", "被伤过的心还可以爱谁", "我爱的男人变了心", "爱要逃", "我们的纪念", "爱火", "星月落", 
                "孤身", "向云端", "彩虹的微笑", "巴黎23号", "我落泪情绪零碎", "会呼吸的痛", "算了", "破鞋子", "憋心", "致命情人", "飞云之下", 
                "孤单夜莺", "留什么给你", "怀念青春", "红尘来去一场梦", "天际", "有你在", "不要在我寂寞的时候说爱我", "梦里水乡", "一花一世界", 
                "赐伤", "面具", "多余的解释", "我在景德镇等你", "我把往事化如烟", "离别开出花", "要不然我们就这样一万年", "晚秋", "曾经你说", 
                "迟来的爱", "野草与栀子花", "再现也不空", "我又想你了", "下个路口见", "有形的翅膀", "靠近", "夜不能寐", "心痛2009", "清晨粥深夜酒", 
                "字字句句", "天若有情", "掏空", "最后一页", "剑魂", "学猫叫", "伤心的时候可以听情歌", "小城画师", "小星星", "远走高飞", "有生之恋", 
                "毕竟深爱过", "纳西情歌", "郎的诱惑", "命运", "西楼儿女", "么么哒", "负我不负她", "心上的罗加", "六楼", "幸福了然后呢", "好想复制一个你", 
                "若是月亮还没来", "相思帕", "光亮", "落", "等爱的玫瑰", "自由飞翔", "伤离别", "20岁30岁40岁", "奈何岁月", "探窗", "九十九步退一步", 
                "放", "这一路", "突然的自我", "我认", "在劫难逃", "爱的回归线", "东南西北风", "江南的风吹落江北的雨", "万物生", "西厢寻他", "最后一页", 
                "放空", "辞九门回忆", "凉城", "诺言", "会开花的云", "背对背拥抱", "小三", "桃花诺", "青花", "那个", "白鸽乌鸦相爱的戏码", "我也不想这样", 
                "一句先苦后甜", "小美满", "苦笑", "犯贱", "天真", "红装", "和平分手", "坏女孩", "小酒窝", "画心", "错都错了", "放纵", "小情歌", "我知道", 
                "最初的记忆", "伤心剖半", "我记得我爱过", "茶花开了", "舍得", "我曾用心爱着你", "天下", "一样的月光", "为爱值得", "听说当初你找过我", 
                "1314公里", "心剖开来", "我们的明天", "我想你了", "野人", "只要有你", "爱情买卖", "情歌", "潮湿的心", "轻舞", "花轿里的人", "月亮照山川", 
                "问风", "春风十里", "罗刹海市", "难解", "大山", "情如风", "情罪", "猜你的爱", "雪纷飞"
            ],
            recent: [
                "彼岸", "骗我", "贴水浮莲", "奔赴星空", "外愈", "刀马旦", "你的千山万水", "去年夏天", "不染", "独角戏", "此情一直在心间", "请不要对我说Sorry", "你都对我不对", "生日礼物", "痴情冢", "厚颜无耻", "后海酒吧", "被爱融化的雪", "故事还长", "星辰大海", "客官不可以", "筝语", "他他他", "火苗", "你走吧", "野子", "相见非欢", "小野猫", "早安隆回", "不爱又何必纠缠", "童话镇", "荒漠", "善变", "兰花草", "辞九门回忆", "叹云兮", "泡沫", "旧梦", "失控", "最后的人", "忘了", "如果爱忘了", "是妈妈是女儿", "真的爱着你", "阿拉斯加海湾", "可能", "三月三", "难却", "九儿", "放过自己", "姑娘在远方", "寄长月", "春泥", "余香", "被伤过的心还可以爱谁", "我爱的男人变了心", "爱要逃", "我们的纪念", "爱火", "星月落", "孤身", "向云端", "彩虹的微笑", "巴黎23号", "我落泪情绪零碎", "会呼吸的痛", "算了", "破鞋子", "憋心", "致命情人", "飞云之下", "孤单夜莺", "留什么给你", "怀念青春", "红尘来去一场梦", "天际", "有你在", "不要在我寂寞的时候说爱我", "梦里水乡", "一花一世界", "赐伤", "面具", "多余的解释", "我在景德镇等你", "我把往事化如烟", "离别开出花", "要不然我们就这样一万年", "晚秋", "曾经你说", "迟来的爱", "野草与栀子花", "再现也不空", "我又想你了", "下个路口见", "有形的翅膀", "靠近", "夜不能寐", "心痛2009", "清晨粥深夜酒", "字字句句", "天若有情", "掏空", "最后一页", "剑魂", "学猫叫", "伤心的时候可以听情歌", "小城画师", "小星星", "远走高飞", "有生之恋", "毕竟深爱过", "纳西情歌", "郎的诱惑", "命运", "西楼儿女", "么么哒", "负我不负她", "心上的罗加", "六楼", "幸福了然后呢", "好想复制一个你", "若是月亮还没来", "相思帕", "光亮", "落", "等爱的玫瑰", "自由飞翔", "伤离别", "20岁30岁40岁", "奈何岁月", "探窗", "九十九步退一步", "放", "这一路", "突然的自我", "我认", "在劫难逃", "爱的回归线", "东南西北风", "江南的风吹落江北的雨", "万物生", "西厢寻他", "最后一页", "放空", "辞九门回忆", "凉城", "诺言", "会开花的云", "背对背拥抱", "小三", "桃花诺", "青花", "那个", "白鸽乌鸦相爱的戏码", "我也不想这样", "一句先苦后甜", "小美满", "苦笑", "犯贱", "天真", "红装", "和平分手", "坏女孩", "小酒窝", "画心", "错都错了", "放纵", "小情歌", "我知道", "最初的记忆", "伤心剖半", "我记得我爱过", "茶花开了", "舍得", "我曾用心爱着你", "天下", "一样的月光", "为爱值得", "听说当初你找过我", "1314公里", "心剖开来", "我们的明天", "我想你了", "野人", "只要有你", "爱情买卖", "情歌", "潮湿的心", "轻舞", "花轿里的人", "月亮照山川", "问风", "春风十里", "罗刹海市", "难解", "大山", "情罪", "猜你的爱", "情如风"
            ],
            ancient: [
                "女儿情", "渡红尘", "风筝误", "芙蓉雨", "九张机"
            ],
            pop: [
                "野花香", "干就得了", "逃之夭夭", "燃烧爱", "失恋阵线联盟", "一物降一物", "与爱共舞", "责无旁贷", "あいしてる我爱你", "全是爱", "你在他乡还好吗"
            ],
            grassland: [
                "我从草原来", "梦草原", "姑娘爱情郎", "火苗", "爱火", "高原蓝", "套马杆"
            ],
            highNote: [
                "朝圣者", "天籁之爱", "阿刁", "我的楼兰", "不染", "我的心", "人世间"
            ],
            cantonese: [
                "真的爱着你", "喜欢你", "讲不出再见", "十七岁", "晚风1997", "情如风", "孤单夜莺", "最爱", "漫步人生路"
            ]
        };

        // 已选择的歌曲记录
        let selectedSongs = {
            all: [],
            recent: [],
            ancient: [],
            pop: [],
            grassland: [],
            highNote: [],
            cantonese: []
        };

        // 全局变量
        let songContainer;
        let startTime; // 开播时间
        let scrollInterval; // 滚动动画帧ID
        let scrollTimeout; // 恢复滚动计时器
        let isScrolling = false; // 是否正在滚动
        let scrollPosition = 0; // 滚动位置
        
        // 初始化
        function init() {
            // DOM元素 - 在DOM完全加载后获取
            const randomBtn = document.getElementById('randomBtn');
            const recentBtn = document.getElementById('recentBtn');
            const ancientBtn = document.getElementById('ancientBtn');
            const popBtn = document.getElementById('popBtn');
            const grasslandBtn = document.getElementById('grasslandBtn');
            const highNoteBtn = document.getElementById('highNoteBtn');
            const cantoneseBtn = document.getElementById('cantoneseBtn');
            const resetBtn = document.getElementById('resetBtn');
            songContainer = document.getElementById('songContainer');
            
            // 添加按钮事件监听
            if (randomBtn) randomBtn.addEventListener('click', () => getRandomSongs('all'));
            if (recentBtn) recentBtn.addEventListener('click', () => getRandomSongs('recent'));
            if (ancientBtn) ancientBtn.addEventListener('click', () => getRandomSongs('ancient'));
            if (popBtn) popBtn.addEventListener('click', () => getRandomSongs('pop'));
            if (grasslandBtn) grasslandBtn.addEventListener('click', () => getRandomSongs('grassland'));
            if (highNoteBtn) highNoteBtn.addEventListener('click', () => getRandomSongs('highNote'));
            if (cantoneseBtn) cantoneseBtn.addEventListener('click', () => getRandomSongs('cantonese'));
            if (resetBtn) resetBtn.addEventListener('click', resetApp);
            
            // 初始化时间显示
            initTimeDisplay();
            
            // 初始化自动滚动歌单
            initScrollingPlaylist();
        }
        
        // 初始化自动滚动歌单
        function initScrollingPlaylist() {
            const scrollContainer = document.getElementById('scrollContainer');
            const songScrollList = document.getElementById('songScrollList');
            
            if (!scrollContainer || !songScrollList) return;
            
            // 生成歌曲列表
            generateScrollingSongList();
            
            // 初始化时检查并添加飞入特效
            setTimeout(checkAndAddFlyInEffect, 100);
            
            // 设置自动滚动
            startAutoScroll();
            
            // 添加鼠标悬停事件
            scrollContainer.addEventListener('mouseenter', () => {
                stopAutoScroll();
            });
            
            scrollContainer.addEventListener('mouseleave', () => {
                startAutoScroll();
            });
            
            // 添加鼠标滚轮事件
            scrollContainer.addEventListener('wheel', (e) => {
                e.preventDefault();
                
                // 停止自动滚动
                stopAutoScroll();
                
                // 计算新的滚动位置
                const itemHeight = 32; // 每个歌曲项的高度
                const scrollAmount = e.deltaY * 0.5; // 平滑滚动，只滚动一半的距离
                const newPosition = scrollPosition + scrollAmount;
                
                // 限制滚动范围
                const maxScroll = songDatabase.all.length * itemHeight;
                scrollPosition = Math.max(0, Math.min(newPosition, maxScroll));
                
                // 更新滚动位置
                updateScrollPosition();
                
                // 3秒后恢复自动滚动
                if (scrollTimeout) {
                    clearTimeout(scrollTimeout);
                }
                scrollTimeout = setTimeout(() => {
                    if (!scrollContainer.matches(':hover')) {
                        startAutoScroll();
                    }
                }, 3000);
            });
        }
        
        // 生成滚动歌单列表
        function generateScrollingSongList() {
            const songScrollList = document.getElementById('songScrollList');
            
            if (!songScrollList) return;
            
            // 清空现有内容
            songScrollList.innerHTML = '';
            
            // 使用所有歌曲数据
            const allSongs = [...songDatabase.all];
            
            // 为了实现无缝滚动，复制前10首歌曲添加到列表末尾
            const extendedSongs = [...allSongs, ...allSongs.slice(0, 10)];
            
            // 创建歌曲项
            extendedSongs.forEach((song, index) => {
                const songItem = document.createElement('div');
                songItem.className = 'scroll-song-item';
                
                // 所有歌曲项都有相同的初始状态
                // 动画效果将在checkAndAddFlyInEffect函数中根据视口位置动态添加
                songItem.style.opacity = '1';
                songItem.style.transform = 'translateX(0)';
                songItem.classList.remove('scroll-fly-in', 'scroll-song-animated');
                
                // 隐藏第七行及以下的歌曲
                if (index >= 6) {
                    songItem.classList.add('scroll-song-hidden');
                } else {
                    songItem.classList.remove('scroll-song-hidden');
                }
                
                songItem.innerHTML = `
                    <div class="scroll-song-name">${song}</div>
                    <button class="scroll-copy-btn bg-secondary hover:bg-blue-600 text-white py-1 px-3 rounded-full text-sm transition-colors duration-200 flex items-center" data-song="${song}">
                        <i class="fa fa-copy mr-1"></i> 复制
                    </button>
                `;
                
                songScrollList.appendChild(songItem);
                
                // 添加复制按钮事件
                const copyBtn = songItem.querySelector('.scroll-copy-btn');
                copyBtn.addEventListener('click', (e) => {
                    const songToCopy = e.currentTarget.getAttribute('data-song');
                    copyToClipboard(songToCopy);
                    
                    // 按钮动画反馈
                    e.currentTarget.innerHTML = '<i class="fa fa-check mr-1"></i> 已复制';
                    e.currentTarget.classList.remove('bg-secondary', 'hover:bg-blue-600');
                    e.currentTarget.classList.add('bg-green-500');
                    
                    setTimeout(() => {
                        e.currentTarget.innerHTML = '<i class="fa fa-copy mr-1"></i> 复制';
                        e.currentTarget.classList.remove('bg-green-500');
                        e.currentTarget.classList.add('bg-secondary', 'hover:bg-blue-600');
                    }, 1500);
                });
            });
        }
        
        // 开始自动滚动
        function startAutoScroll() {
            if (isScrolling) return;
            
            isScrolling = true;
            
            // 清除现有定时器或动画
            if (scrollInterval) {
                cancelAnimationFrame(scrollInterval);
            }
            
            // 根据当前设置获取滚动速度
            let scrollTimePerItem = 75; // 默认中等速度：0.075秒（原速度的2倍）
            if (currentScrollSpeed === 'slow') {
                scrollTimePerItem = 150; // 慢速度：0.15秒（原速度的2倍）
            } else if (currentScrollSpeed === 'fast') {
                scrollTimePerItem = 37.5; // 快速度：0.0375秒（原速度的2倍）
            }
            
            const itemHeight = 32; // 每个歌曲项的高度
            const scrollSpeed = itemHeight / scrollTimePerItem; // 滚动速度：px/ms
            
            // 动画函数
            function animateScroll() {
                // 更新滚动位置
                scrollPosition += scrollSpeed;
                
                const maxScroll = songDatabase.all.length * itemHeight;
                
                // 检查是否需要重置滚动位置
                if (scrollPosition >= maxScroll) {
                    scrollPosition = 0;
                    // 重置所有歌曲的动画状态
                    resetAllSongAnimations();
                }
                
                // 更新滚动位置
                updateScrollPosition();
                
                // 继续动画
                if (isScrolling) {
                    scrollInterval = requestAnimationFrame(animateScroll);
                }
            }
            
            // 开始动画
            scrollInterval = requestAnimationFrame(animateScroll);
        }
        
        // 重置所有歌曲的动画状态
        function resetAllSongAnimations() {
            const songScrollList = document.getElementById('songScrollList');
            const songItems = songScrollList.querySelectorAll('.scroll-song-item');
            
            songItems.forEach((songItem, index) => {
                // 移除所有动画相关的类和样式
                songItem.classList.remove('scroll-fly-in', 'scroll-song-animated');
                songItem.style.animation = '';
                songItem.style.animationDelay = '';
                
                // 所有歌曲项都有相同的初始状态
                // 动画效果将在checkAndAddFlyInEffect函数中根据视口位置动态添加
                songItem.style.opacity = '1';
                songItem.style.transform = 'translateX(0)';
                
                // 隐藏第七行及以下的歌曲
                if (index >= 6) {
                    songItem.classList.add('scroll-song-hidden');
                } else {
                    songItem.classList.remove('scroll-song-hidden');
                }
            });
        }
        
        // 停止自动滚动
        function stopAutoScroll() {
            if (!isScrolling) return;
            
            isScrolling = false;
            
            // 清除动画
            if (scrollInterval) {
                cancelAnimationFrame(scrollInterval);
                scrollInterval = null;
            }
        }
        
        // 重启自动滚动（用于更新滚动速度）
        function restartAutoScroll() {
            if (isScrolling) {
                stopAutoScroll();
                setTimeout(startAutoScroll, 100);
            }
        }
        
        // 更新滚动位置
        function updateScrollPosition() {
            const songScrollList = document.getElementById('songScrollList');
            
            if (!songScrollList) return;
            
            // 使用transform实现平滑滚动
            songScrollList.style.transform = `translateY(-${scrollPosition}px)`;
            
            // 检测并添加飞入特效
            checkAndAddFlyInEffect();
        }
        
        // 检测并为进入视口的歌曲添加飞入特效
        function checkAndAddFlyInEffect() {
            const songScrollList = document.getElementById('songScrollList');
            const songItems = songScrollList.querySelectorAll('.scroll-song-item');
            const itemHeight = 32; // 每个歌曲项的高度
            const visibleCount = 7; // 可见歌曲数量
            
            // 计算当前可见区域的起始索引
            const startIndex = Math.floor(scrollPosition / itemHeight);
            
            // 先隐藏所有第七行及以下的歌曲
            for (let i = 0; i < songItems.length; i++) {
                const songItem = songItems[i];
                // 移除所有动画相关的类
                songItem.classList.remove('scroll-fly-in', 'scroll-song-animated');
                
                // 隐藏第七行及以下的歌曲
                if (i >= 6) {
                    songItem.classList.add('scroll-song-hidden');
                } else {
                    songItem.classList.remove('scroll-song-hidden');
                }
            }
            
            // 为即将进入视口的歌曲添加飞入特效
            for (let i = startIndex; i < startIndex + visibleCount && i < songItems.length; i++) {
                const songItem = songItems[i];
                
                // 计算歌曲在视口中的相对位置（0-6）
                const positionInView = i - startIndex;
                
                // 首5行歌曲直接显示
                if (positionInView < 5) {
                    songItem.style.opacity = '1';
                    songItem.style.transform = 'translateX(0)';
                    songItem.classList.remove('scroll-song-hidden');
                }
                // 第六行歌曲需要飞入特效
                else if (positionInView === 5) {
                    // 添加动画标记类
                    songItem.classList.add('scroll-song-animated');
                    
                    // 添加动画类来触发飞入效果
                    songItem.classList.add('scroll-fly-in');
                    
                    // 显示歌曲
                    songItem.classList.remove('scroll-song-hidden');
                    
                    // 调试：确保动画类被正确添加
                    console.log(`添加动画类到视口第六行: ${songItem.textContent.trim()}`);
                }
                // 第七行歌曲直接显示
                else if (positionInView === 6) {
                    songItem.style.opacity = '1';
                    songItem.style.transform = 'translateX(0)';
                    songItem.classList.remove('scroll-song-hidden');
                }
            }
        }
        
        // 初始化时间显示
        function initTimeDisplay() {
            // 设置开播时间
            startTime = new Date();
            
            // 显示开播时间
            const startTimeElement = document.getElementById('startTime');
            if (startTimeElement) {
                startTimeElement.textContent = `开播时间：${formatDateTime(startTime)}`;
            }
            
            // 更新时间显示
            updateTimeDisplay();
            
            // 每秒更新一次时间显示
            setInterval(updateTimeDisplay, 1000);
        }
        
        // 更新时间显示
        function updateTimeDisplay() {
            // 显示当前时间
            const currentTimeElement = document.getElementById('currentTime');
            if (currentTimeElement) {
                const now = new Date();
                currentTimeElement.textContent = `目前时间：${formatDateTime(now)}`;
            }
            
            // 显示累计时间
            const elapsedTimeElement = document.getElementById('elapsedTime');
            if (elapsedTimeElement && startTime) {
                const now = new Date();
                const elapsedTime = now - startTime;
                elapsedTimeElement.textContent = `开播累计时间：${formatDuration(elapsedTime)}`;
            }
        }
        
        // 格式化日期时间
        function formatDateTime(date) {
            const year = date.getFullYear();
            const month = padZero(date.getMonth() + 1);
            const day = padZero(date.getDate());
            const hours = padZero(date.getHours());
            const minutes = padZero(date.getMinutes());
            const seconds = padZero(date.getSeconds());
            
            return `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`;
        }
        
        // 格式化时长（毫秒）
        function formatDuration(durationMs) {
            const seconds = Math.floor(durationMs / 1000);
            const minutes = Math.floor(seconds / 60);
            const hours = Math.floor(minutes / 60);
            
            const remainingSeconds = padZero(seconds % 60);
            const remainingMinutes = padZero(minutes % 60);
            const remainingHours = padZero(hours);
            
            return `${remainingHours}:${remainingMinutes}:${remainingSeconds}`;
        }
        
        // 数字补零
        function padZero(num) {
            return num.toString().padStart(2, '0');
        }

        // 获取随机歌曲
        function getRandomSongs(type) {
            const availableSongs = songDatabase[type].filter(song => !selectedSongs[type].includes(song));
            
            // 类型到分类名称的映射
            const typeNames = {
                'all': '所有歌曲',
                'recent': '最近学会歌曲',
                'ancient': '古风歌',
                'pop': '欢快',
                'grassland': '草原歌',
                'highNote': '高音歌',
                'cantonese': '粤语歌'
            };
            
            // 如果所有歌曲都已选择过，重置已选择记录
            if (availableSongs.length < 3) {
                selectedSongs[type] = [];
                showNotification(`已重置${typeNames[type]}的选择记录`);
                return getRandomSongs(type); // 重新获取
            }
            
            // 随机选择3首歌曲
            const shuffled = [...availableSongs].sort(() => 0.5 - Math.random());
            const selected = shuffled.slice(0, 3);
            
            // 更新已选择记录
            selectedSongs[type] = [...selectedSongs[type], ...selected];
            
            // 显示歌曲
            displaySongs(selected);
        }

        // 显示歌曲
        function displaySongs(songs) {
            if (!songContainer) return;
            
            songContainer.innerHTML = '';
            
            songs.forEach((song, index) => {
                const songCard = document.createElement('div');
                songCard.className = 'song-card';
                songCard.style.opacity = '0';
                songCard.style.transform = 'translateY(20px)';
                songCard.style.transition = 'opacity 0.5s ease, transform 0.5s ease';
                
                songCard.innerHTML = `
                    <div class="flex items-center">
                        <span class="inline-flex items-center justify-center bg-primary text-white rounded-full w-8 h-8 mr-3">
                            ${index + 1}
                        </span>
                        <span class="text-lg font-medium text-gray-800">${song}</span>
                    </div>
                    <div class="flex gap-2">
                        <button class="copy-btn bg-secondary hover:bg-blue-600 text-white py-1 px-3 rounded-full text-sm transition-colors duration-200 flex items-center" data-song="${song}">
                            <i class="fa fa-copy mr-1"></i> 复制
                        </button>
                        <button class="like-btn bg-gray-200 hover:bg-gray-300 text-gray-700 py-1 px-3 rounded-full text-sm transition-colors duration-200 flex items-center" data-song="${song}">
                            <i class="fa fa-heart-o mr-1"></i> 喜欢
                        </button>
                    </div>
                `;
                
                songContainer.appendChild(songCard);
                
                // 添加动画效果
                setTimeout(() => {
                    songCard.style.opacity = '1';
                    songCard.style.transform = 'translateY(0)';
                }, index * 100);
                
                // 添加复制按钮事件
                const copyBtn = songCard.querySelector('.copy-btn');
                copyBtn.addEventListener('click', (e) => {
                    const songToCopy = e.currentTarget.getAttribute('data-song');
                    copyToClipboard(songToCopy);
                    
                    // 按钮动画反馈
                    e.currentTarget.innerHTML = '<i class="fa fa-check mr-1"></i> 已复制';
                    e.currentTarget.classList.remove('bg-secondary', 'hover:bg-blue-600');
                    e.currentTarget.classList.add('bg-green-500');
                    
                    setTimeout(() => {
                        e.currentTarget.innerHTML = '<i class="fa fa-copy mr-1"></i> 复制';
                        e.currentTarget.classList.remove('bg-green-500');
                        e.currentTarget.classList.add('bg-secondary', 'hover:bg-blue-600');
                    }, 1500);
                });
                
                // 添加喜欢按钮事件
                const likeBtn = songCard.querySelector('.like-btn');
                likeBtn.addEventListener('click', (e) => {
                    const songToLike = e.currentTarget.getAttribute('data-song');
                    toggleLike(songToLike, e.currentTarget);
                });
            });
            
            // 保存到历史记录
            songs.forEach(song => saveHistory(song));
        }

        // 复制到剪贴板 - 增强版
        function copyToClipboard(text) {
            // 首先尝试使用 Clipboard API
            if (navigator.clipboard && window.isSecureContext) {
                return navigator.clipboard.writeText(text)
                    .then(() => {
                        showNotification(`已复制: ${text}`);
                        return true;
                    })
                    .catch(err => {
                        console.warn('Clipboard API 失败，尝试备用方法:', err);
                        return fallbackCopyTextToClipboard(text);
                    });
            } else {
                // 直接使用备用方法
                return fallbackCopyTextToClipboard(text);
            }
        }

        // 备用复制方法 - 使用 textarea 元素
        function fallbackCopyTextToClipboard(text) {
            // 创建临时 textarea 元素
            const textarea = document.createElement('textarea');
            textarea.value = text;
            
            // 设置样式使其不可见但仍可选择
            textarea.style.position = 'fixed';
            textarea.style.opacity = '0';
            textarea.style.left = '-999999px';
            textarea.style.top = '-999999px';
            
            document.body.appendChild(textarea);
            
            try {
                // 选中 textarea 内容
                textarea.select();
                textarea.setSelectionRange(0, 999999); // 兼容移动设备
                
                // 执行复制命令
                const successful = document.execCommand('copy');
                
                if (successful) {
                    showNotification(`已复制: ${text}`);
                    return true;
                } else {
                    throw new Error('document.execCommand("copy") 失败');
                }
            } catch (err) {
                console.error('备用复制方法失败:', err);
                showNotification('复制失败，请手动复制', 'error');
                return false;
            } finally {
                // 无论成功失败，都移除临时元素
                document.body.removeChild(textarea);
            }
        }

        // 显示通知
        function showNotification(message, type = 'success') {
            // 创建通知元素
            const notification = document.createElement('div');
            notification.className = `fixed bottom-4 right-4 px-6 py-3 rounded-lg shadow-lg z-50 transition-all duration-300 transform translate-y-10 opacity-0 flex items-center`;
            notification.style.fontSize = `calc(1rem * var(--base-size))`;
            notification.style.padding = `calc(0.75rem * var(--base-size)) calc(1.5rem * var(--base-size))`;
            notification.style.borderRadius = `calc(0.5rem * var(--base-size))`;
            notification.style.bottom = `calc(1rem * var(--base-size))`;
            notification.style.right = `calc(1rem * var(--base-size))`;
            
            // 根据类型设置样式
            if (type === 'success') {
                notification.classList.add('bg-green-500', 'text-white');
                notification.innerHTML = `<i class="fa fa-check-circle mr-2"></i> ${message}`;
            } else {
                notification.classList.add('bg-red-500', 'text-white');
                notification.innerHTML = `<i class="fa fa-exclamation-circle mr-2"></i> ${message}`;
            }
            
            // 添加到页面
            document.body.appendChild(notification);
            
            // 显示通知
            setTimeout(() => {
                notification.classList.remove('translate-y-10', 'opacity-0');
            }, 10);
            
            // 自动关闭
            setTimeout(() => {
                notification.classList.add('translate-y-10', 'opacity-0');
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }

        // 重置应用
        function resetApp() {
            selectedSongs = {
                all: [],
                recent: [],
                ancient: [],
                pop: [],
                grassland: [],
                highNote: [],
                cantonese: []
            };
            
            if (songContainer) {
                songContainer.innerHTML = '<div class="text-center text-gray-500 italic">点击上方按钮开始点歌</div>';
                
                // 添加重置动画效果
                songContainer.classList.add('animate-pulse');
                setTimeout(() => {
                    songContainer.classList.remove('animate-pulse');
                }, 1000);
            }
            
            showNotification('已重置所有选择记录');
        }

        // 搜索功能
        function searchSongs(keyword) {
            if (!keyword || keyword.trim().length === 0) return [];
            
            const lowerKeyword = keyword.toLowerCase().trim();
            const results = [];
            
            // 遍历所有歌曲分类
            Object.keys(songDatabase).forEach(category => {
                const songs = songDatabase[category];
                const matchedSongs = songs.filter(song => 
                    song.toLowerCase().includes(lowerKeyword)
                ).map(song => ({
                    name: song,
                    category: category
                }));
                
                results.push(...matchedSongs);
            });
            
            // 去重
            const uniqueResults = Array.from(new Map(results.map(item => [item.name, item])).values());
            
            return uniqueResults;
        }
        
        // 高亮搜索结果中的匹配部分
        function highlightMatch(text, keyword) {
            if (!keyword || keyword.trim().length === 0) return text;
            
            const lowerKeyword = keyword.toLowerCase();
            const index = text.toLowerCase().indexOf(lowerKeyword);
            
            if (index === -1) return text;
            
            const match = text.substr(index, keyword.length);
            return text.substr(0, index) + `<span class="bg-yellow-200 font-medium">${match}</span>` + text.substr(index + keyword.length);
        }
        
        // 显示搜索结果
        function displaySearchResults(results, keyword) {
            const searchResults = document.getElementById('searchResults');
            
            if (!searchResults) return;
            
            if (results.length === 0) {
                searchResults.innerHTML = '<div class="p-4 text-center text-gray-500">没有找到匹配的歌曲</div>';
                searchResults.classList.remove('hidden');
                return;
            }
            
            // 类型到分类名称的映射
            const typeNames = {
                'all': '所有歌曲',
                'recent': '最近学会',
                'ancient': '古风歌',
                'pop': '欢快',
                'grassland': '草原歌',
                'highNote': '高音歌',
                'cantonese': '粤语歌'
            };
            
            // 按分类分组显示
            const groupedResults = {};
            results.forEach(song => {
                if (!groupedResults[song.category]) {
                    groupedResults[song.category] = [];
                }
                groupedResults[song.category].push(song);
            });
            
            let html = '';
            Object.keys(groupedResults).forEach(category => {
                html += `<div class="border-b border-gray-100 last:border-0">`;
                html += `<div class="bg-gray-50 px-4 py-2 font-medium text-gray-700">${typeNames[category] || category}</div>`;
                html += `<div class="divide-y divide-gray-100">`;
                
                groupedResults[category].forEach(song => {
                    html += `
                        <div class="p-3 hover:bg-gray-50 transition-colors duration-150 flex justify-between items-center">
                            <div class="flex items-center">
                                <i class="fa fa-music text-primary mr-2"></i>
                                <span>${highlightMatch(song.name, keyword)}</span>
                            </div>
                            <button class="search-copy-btn bg-secondary hover:bg-blue-600 text-white py-1 px-3 rounded-full text-sm transition-colors duration-200 flex items-center" data-song="${song.name}">
                                <i class="fa fa-copy mr-1"></i> 复制
                            </button>
                        </div>
                    `;
                });
                
                html += `</div></div>`;
            });
            
            searchResults.innerHTML = html;
            searchResults.classList.remove('hidden');
            
            // 添加复制按钮事件
            const copyButtons = searchResults.querySelectorAll('.search-copy-btn');
            copyButtons.forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const songToCopy = e.currentTarget.getAttribute('data-song');
                    copyToClipboard(songToCopy);
                    
                    // 按钮动画反馈
                    e.currentTarget.innerHTML = '<i class="fa fa-check mr-1"></i> 已复制';
                    e.currentTarget.classList.remove('bg-secondary', 'hover:bg-blue-600');
                    e.currentTarget.classList.add('bg-green-500');
                    
                    setTimeout(() => {
                        e.currentTarget.innerHTML = '<i class="fa fa-copy mr-1"></i> 复制';
                        e.currentTarget.classList.remove('bg-green-500');
                        e.currentTarget.classList.add('bg-secondary', 'hover:bg-blue-600');
                    }, 1500);
                });
            });
        }
        
        // 初始化搜索功能
        function initSearch() {
            const searchInput = document.getElementById('searchInput');
            const searchBtn = document.getElementById('searchBtn');
            const clearSearchBtn = document.getElementById('clearSearchBtn');
            const searchResults = document.getElementById('searchResults');
            
            if (!searchInput || !searchBtn || !clearSearchBtn || !searchResults) return;
            
            // 搜索按钮点击事件
            searchBtn.addEventListener('click', () => {
                const keyword = searchInput.value;
                const results = searchSongs(keyword);
                displaySearchResults(results, keyword);
            });
            
            // 搜索框输入事件（实时搜索）
            searchInput.addEventListener('input', () => {
                const keyword = searchInput.value;
                
                // 显示/隐藏清除按钮
                if (keyword && keyword.trim().length > 0) {
                    clearSearchBtn.classList.remove('hidden');
                } else {
                    clearSearchBtn.classList.add('hidden');
                    searchResults.classList.add('hidden');
                }
                
                // 实时搜索
                const results = searchSongs(keyword);
                displaySearchResults(results, keyword);
            });
            
            // 清除搜索按钮点击事件
            clearSearchBtn.addEventListener('click', () => {
                searchInput.value = '';
                clearSearchBtn.classList.add('hidden');
                searchResults.classList.add('hidden');
            });
            
            // 搜索框回车事件
            searchInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    const keyword = searchInput.value;
                    const results = searchSongs(keyword);
                    displaySearchResults(results, keyword);
                }
            });
            
            // 点击页面其他地方关闭搜索结果
            document.addEventListener('click', (e) => {
                if (!searchInput.contains(e.target) && !searchResults.contains(e.target) && e.target !== searchBtn) {
                    searchResults.classList.add('hidden');
                }
            });
        }
        
        // 历史记录功能 - 简化版
        function saveHistory(song) {
            // 获取现有历史记录
            let history = getHistory();
            
            // 检查历史记录是否超过2000条，如果是则清空
            if (history.length >= 2000) {
                // 清空历史记录
                history = [];
                
                // 显示通知
                showNotification('历史记录已超过2000条，已自动清空');
            }
            
            // 添加新记录到开头
            history.unshift({ 
                name: song, 
                timestamp: new Date().toISOString(),
                id: Date.now() // 用于唯一标识
            });
            
            // 保存到localStorage
            localStorage.setItem('songHistory', JSON.stringify(history));
            
            // 更新历史记录显示
            updateHistoryDisplay();
        }
        
        // 从localStorage获取历史记录
        function getHistory() {
            const history = localStorage.getItem('songHistory');
            return history ? JSON.parse(history) : [];
        }
        
        // 更新历史记录显示
        function updateHistoryDisplay() {
            const history = getHistory();
            const historyList = document.getElementById('historyList');
            const historyBadge = document.getElementById('historyBadge');
            
            if (!historyList || !historyBadge) return;
            
            // 更新历史记录数量
            historyBadge.textContent = history.length;
            
            if (history.length === 0) {
                historyList.innerHTML = '<div class="text-center text-gray-500 py-4">暂无历史记录</div>';
                return;
            }
            
            // 显示历史记录
            let html = '';
            history.forEach((item, index) => {
                const date = new Date(item.timestamp);
                const formattedTime = `${padZero(date.getHours())}:${padZero(date.getMinutes())}:${padZero(date.getSeconds())}`;
                
                // 使用HTML onclick直接绑定事件，避免事件委托问题
                html += `
                    <div class="p-3 hover:bg-gray-50 transition-colors duration-150 flex justify-between items-center">
                        <div class="flex items-center">
                            <span class="inline-flex items-center justify-center bg-gray-300 text-gray-700 rounded-full w-6 h-6 mr-3 text-xs">
                                ${index + 1}
                            </span>
                            <div>
                                <div class="font-medium text-gray-800 history-song-name">${item.name}</div>
                            </div>
                        </div>
                        <div class="flex gap-2">
                            <button class="history-copy-btn bg-secondary hover:bg-blue-600 text-white py-1 px-3 rounded-full text-sm transition-colors duration-200 flex items-center" onclick="copyHistorySong('${item.name}')">
                                <i class="fa fa-copy mr-1"></i> 复制
                            </button>
                            <button class="history-delete-btn bg-gray-200 hover:bg-gray-400 text-gray-700 py-1 px-2 rounded-full text-sm transition-colors duration-200 flex items-center" onclick="deleteHistoryItem(${item.id})">
                                <i class="fa fa-times"></i>
                            </button>
                        </div>
                    </div>
                `;
            });
            
            historyList.innerHTML = html;
        }
        
        // 复制历史记录中的歌曲 - 使用全局函数确保可访问性
        window.copyHistorySong = function(songName) {
            copyToClipboard(songName);
            
            // 显示通知
            showNotification(`已复制: ${songName}`);
        }
        
        // 删除历史记录项 - 使用全局函数确保可访问性
        window.deleteHistoryItem = function(id) {
            const history = getHistory();
            const updatedHistory = history.filter(item => item.id !== id);
            
            localStorage.setItem('songHistory', JSON.stringify(updatedHistory));
            updateHistoryDisplay();
            
            showNotification('已删除历史记录');
        }
        
        // 清空历史记录 - 使用全局函数确保可访问性
        window.clearHistory = function() {
            if (confirm('确定要清空所有历史记录吗？')) {
                // 直接设置为空数组
                localStorage.setItem('songHistory', JSON.stringify([]));
                
                // 直接更新UI
                const historyList = document.getElementById('historyList');
                const historyBadge = document.getElementById('historyBadge');
                const clearHistoryBtn = document.getElementById('clearHistoryBtn');
                
                if (historyList) {
                    historyList.innerHTML = '<div class="text-center text-gray-500 py-4">暂无历史记录</div>';
                }
                
                if (historyBadge) {
                    historyBadge.textContent = '0';
                }
                
                if (clearHistoryBtn) {
                    clearHistoryBtn.classList.add('hidden');
                }
                
                showNotification('已清空所有历史记录');
            }
        }
        
        // 初始化历史记录功能
        function initHistory() {
            const toggleHistoryBtn = document.getElementById('toggleHistoryBtn');
            const historyContainer = document.getElementById('historyContainer');
            
            if (!toggleHistoryBtn || !historyContainer) return;
            
            // 切换历史记录显示/隐藏
            toggleHistoryBtn.addEventListener('click', () => {
                historyContainer.classList.toggle('hidden');
                
                // 更改按钮图标和文字
                const icon = toggleHistoryBtn.querySelector('i');
                if (historyContainer.classList.contains('hidden')) {
                    icon.className = 'fa fa-chevron-down mr-1';
                    toggleHistoryBtn.innerHTML = '<i class="fa fa-chevron-down mr-1"></i> 查看';
                } else {
                    icon.className = 'fa fa-chevron-up mr-1';
                    toggleHistoryBtn.innerHTML = '<i class="fa fa-chevron-up mr-1"></i> 收起';
                }
            });
            

            
            // 初始化历史记录显示
            updateHistoryDisplay();
        }
        
        // 喜欢功能
        function toggleLike(song, button) {
            // 获取喜欢的歌曲
            let likedSongs = getLikedSongs();
            
            // 检查是否已经喜欢
            const index = likedSongs.indexOf(song);
            if (index === -1) {
                // 添加到喜欢列表
                likedSongs.push(song);
                button.innerHTML = '<i class="fa fa-heart text-red-500 mr-1"></i> 已喜欢';
                button.classList.remove('bg-gray-200', 'hover:bg-gray-300', 'text-gray-700');
                button.classList.add('bg-red-100', 'hover:bg-red-200', 'text-red-500');
                showNotification(`已添加到喜欢: ${song}`);
            } else {
                // 从喜欢列表中移除
                likedSongs.splice(index, 1);
                button.innerHTML = '<i class="fa fa-heart-o mr-1"></i> 喜欢';
                button.classList.remove('bg-red-100', 'hover:bg-red-200', 'text-red-500');
                button.classList.add('bg-gray-200', 'hover:bg-gray-300', 'text-gray-700');
                showNotification(`已取消喜欢: ${song}`);
            }
            
            // 保存到localStorage
            localStorage.setItem('likedSongs', JSON.stringify(likedSongs));
        }
        
        // 获取喜欢的歌曲
        function getLikedSongs() {
            const likedSongs = localStorage.getItem('likedSongs');
            return likedSongs ? JSON.parse(likedSongs) : [];
        }
        
        // 主题切换功能
        let currentTheme = 'light';
        let currentColor = 'red';
        let currentSize = 'small'; // 界面大小：large, medium, small, tiny
        let currentScrollSpeed = 'medium'; // 滚动速度：slow, medium, fast
        
        // 初始化主题
        function initTheme() {
            // 从localStorage获取保存的主题设置
            const savedTheme = localStorage.getItem('preferredTheme');
            const savedColor = localStorage.getItem('preferredColor');
            const savedSize = localStorage.getItem('preferredSize');
            const savedScrollSpeed = localStorage.getItem('preferredScrollSpeed');
            
            if (savedTheme) currentTheme = savedTheme;
            if (savedColor) currentColor = savedColor;
            if (savedSize) currentSize = savedSize;
            if (savedScrollSpeed) currentScrollSpeed = savedScrollSpeed;
            
            // 应用主题
            applyTheme(currentTheme, currentColor, currentSize);
        }
        
        // 应用主题
        function applyTheme(theme, color, size) {
            // 更新当前主题、颜色和大小
            currentTheme = theme;
            currentColor = color;
            currentSize = size || currentSize;
            
            // 如果正在滚动，更新滚动速度
            if (isScrolling) {
                restartAutoScroll();
            }
            
            // 获取对应的颜色配置
            const colors = theme === 'dark' ? darkThemeColors[color] : themeColors[color];
            
            // 更新CSS变量
            document.documentElement.style.setProperty('--primary-color', colors.primary);
            document.documentElement.style.setProperty('--secondary-color', colors.secondary);
            document.documentElement.style.setProperty('--accent-color', colors.accent);
            document.documentElement.style.setProperty('--dark-color', colors.dark);
            document.documentElement.style.setProperty('--light-color', colors.light);
            
            // 设置界面大小
            let sizeValue = 0.8; // 默认小尺寸
            if (size === 'large') sizeValue = 1.2; // 大尺寸
            if (size === 'medium') sizeValue = 1; // 中等尺寸
            if (size === 'tiny') sizeValue = 0.5; // 极小尺寸（缩小一半）
            document.documentElement.style.setProperty('--base-size', sizeValue);
            
            // 更新根元素的类
            document.documentElement.classList.toggle('dark', theme === 'dark');
            
            // 更新背景
            const body = document.body;
            
            if (theme === 'dark') {
                body.classList.remove('bg-gradient-to-br', 'from-blue-50', 'to-purple-50');
                body.classList.add('text-white');
                // 在深色模式下添加半透明背景色，提高可读性
                body.style.backgroundColor = 'rgba(0, 0, 0, 0.7)';
                
                // 深色模式下调整背景图片亮度和对比度
                document.documentElement.style.setProperty('--bg-brightness', '0.4');
                document.documentElement.style.setProperty('--bg-contrast', '1.2');
                document.documentElement.style.setProperty('--bg-opacity', '0.5');
            } else {
                body.classList.remove('bg-gradient-to-br', 'from-gray-900', 'to-gray-800', 'text-white');
                // 在浅色模式下使用默认背景
                body.style.backgroundColor = '';
                
                // 浅色模式下恢复背景图片效果
                document.documentElement.style.setProperty('--bg-brightness', '1');
                document.documentElement.style.setProperty('--bg-contrast', '1');
                document.documentElement.style.setProperty('--bg-opacity', '0.8');
            }
            
            // 更新所有元素的颜色
            updateElementColors();
            
            // 更新主题设置面板中的选中状态
            updateThemeSettingsUI();
        }
        
        // 更新所有元素的颜色
        function updateElementColors() {
            // 更新所有使用primary颜色的元素
            document.querySelectorAll('.bg-primary').forEach(el => {
                el.style.backgroundColor = currentTheme === 'dark' ? `var(--primary-color)` : '';
            });
            
            document.querySelectorAll('.text-primary').forEach(el => {
                el.style.color = currentTheme === 'dark' ? `var(--primary-color)` : '';
            });
            
            // 更新所有使用secondary颜色的元素
            document.querySelectorAll('.bg-secondary').forEach(el => {
                el.style.backgroundColor = currentTheme === 'dark' ? `var(--secondary-color)` : '';
            });
            
            document.querySelectorAll('.text-secondary').forEach(el => {
                el.style.color = currentTheme === 'dark' ? `var(--secondary-color)` : '';
            });
            
            // 更新搜索结果中的高亮颜色
            document.querySelectorAll('.bg-yellow-200').forEach(el => {
                el.style.backgroundColor = currentTheme === 'dark' ? 'rgba(250, 204, 21, 0.3)' : 'var(--accent-color)';
            });
            
            // 更新深色模式下的文本颜色
            if (currentTheme === 'dark') {
                // 更新文本颜色
                document.querySelectorAll('.text-gray-500, .text-gray-600, .text-gray-700, .text-gray-800').forEach(el => {
                    el.style.color = '#cbd5e1'; // text-gray-300 稍深一点的浅灰色，提高可读性
                });
                
                // 更新卡片背景
                document.querySelectorAll('.bg-white, .bg-gray-50').forEach(el => {
                    el.style.backgroundColor = '#1f2937'; // bg-gray-800
                });
                
                // 更新边框颜色
                document.querySelectorAll('.border-gray-100, .border-gray-200').forEach(el => {
                    el.style.borderColor = '#4b5563'; // border-gray-600
                });
                
                // 更新历史记录和搜索结果中的悬停效果
                document.querySelectorAll('.hover\\:bg-gray-50').forEach(el => {
                    el.style.backgroundColor = currentTheme === 'dark' ? '#374151' : ''; // bg-gray-700
                });
            } else {
                // 恢复浅色模式下的样式
                document.querySelectorAll('.text-gray-500, .text-gray-600, .text-gray-700, .text-gray-800').forEach(el => {
                    el.style.color = '';
                });
                
                document.querySelectorAll('.bg-white, .bg-gray-50').forEach(el => {
                    el.style.backgroundColor = '';
                });
                
                document.querySelectorAll('.border-gray-100, .border-gray-200').forEach(el => {
                    el.style.borderColor = '';
                });
                
                document.querySelectorAll('.hover\\:bg-gray-50').forEach(el => {
                    el.style.backgroundColor = '';
                });
            }
        }
        
        // 更新主题设置面板中的选中状态
        function updateThemeSettingsUI() {
            const lightThemeBtn = document.getElementById('lightThemeBtn');
            const darkThemeBtn = document.getElementById('darkThemeBtn');
            const colorOptions = document.querySelectorAll('.color-option');
            const sizeLargeBtn = document.getElementById('sizeLargeBtn');
            const sizeMediumBtn = document.getElementById('sizeMediumBtn');
            const sizeSmallBtn = document.getElementById('sizeSmallBtn');
            const sizeTinyBtn = document.getElementById('sizeTinyBtn');
            const speedSlowBtn = document.getElementById('speedSlowBtn');
            const speedMediumBtn = document.getElementById('speedMediumBtn');
            const speedFastBtn = document.getElementById('speedFastBtn');
            
            if (!lightThemeBtn || !darkThemeBtn || !colorOptions || !sizeLargeBtn || !sizeMediumBtn || !sizeSmallBtn || !sizeTinyBtn || !speedSlowBtn || !speedMediumBtn || !speedFastBtn) return;
            
            // 更新主题模式按钮状态
            if (currentTheme === 'light') {
                lightThemeBtn.classList.add('ring-2', 'ring-primary');
                darkThemeBtn.classList.remove('ring-2', 'ring-primary');
            } else {
                darkThemeBtn.classList.add('ring-2', 'ring-primary');
                lightThemeBtn.classList.remove('ring-2', 'ring-primary');
            }
            
            // 更新颜色选项状态
            colorOptions.forEach(option => {
                const color = option.getAttribute('data-color');
                if (color === currentColor) {
                    option.classList.add('ring-2', 'ring-white', 'ring-offset-2');
                } else {
                    option.classList.remove('ring-2', 'ring-white', 'ring-offset-2');
                }
            });
            
            // 更新界面大小按钮状态
            sizeLargeBtn.classList.remove('ring-2', 'ring-primary');
            sizeMediumBtn.classList.remove('ring-2', 'ring-primary');
            sizeSmallBtn.classList.remove('ring-2', 'ring-primary');
            sizeTinyBtn.classList.remove('ring-2', 'ring-primary');
            
            if (currentSize === 'large') {
                sizeLargeBtn.classList.add('ring-2', 'ring-primary');
            } else if (currentSize === 'medium') {
                sizeMediumBtn.classList.add('ring-2', 'ring-primary');
            } else if (currentSize === 'small') {
                sizeSmallBtn.classList.add('ring-2', 'ring-primary');
            } else if (currentSize === 'tiny') {
                sizeTinyBtn.classList.add('ring-2', 'ring-primary');
            }
            
            // 更新滚动速度按钮状态
            speedSlowBtn.classList.remove('ring-2', 'ring-primary');
            speedMediumBtn.classList.remove('ring-2', 'ring-primary');
            speedFastBtn.classList.remove('ring-2', 'ring-primary');
            
            if (currentScrollSpeed === 'slow') {
                speedSlowBtn.classList.add('ring-2', 'ring-primary');
            } else if (currentScrollSpeed === 'medium') {
                speedMediumBtn.classList.add('ring-2', 'ring-primary');
            } else if (currentScrollSpeed === 'fast') {
                speedFastBtn.classList.add('ring-2', 'ring-primary');
            }
        }
        
        // 初始化主题设置面板
        function initThemeSettings() {
            const settingsBtn = document.getElementById('settingsBtn');
            const themeSettings = document.getElementById('themeSettings');
            const settingsPanel = document.getElementById('settingsPanel');
            const closeSettingsBtn = document.getElementById('closeSettingsBtn');
            const lightThemeBtn = document.getElementById('lightThemeBtn');
            const darkThemeBtn = document.getElementById('darkThemeBtn');
            const colorOptions = document.querySelectorAll('.color-option');
            const saveThemeBtn = document.getElementById('saveThemeBtn');
            const resetThemeBtn = document.getElementById('resetThemeBtn');
            
            if (!settingsBtn || !themeSettings || !settingsPanel || !closeSettingsBtn || 
                !lightThemeBtn || !darkThemeBtn || !colorOptions || !saveThemeBtn || !resetThemeBtn) return;
            
            // 打开设置面板
            settingsBtn.addEventListener('click', () => {
                themeSettings.classList.remove('hidden');
                setTimeout(() => {
                    settingsPanel.classList.remove('scale-95', 'opacity-0');
                    settingsPanel.classList.add('scale-100', 'opacity-100');
                }, 10);
            });
            
            // 关闭设置面板
            closeSettingsBtn.addEventListener('click', () => {
                settingsPanel.classList.remove('scale-100', 'opacity-100');
                settingsPanel.classList.add('scale-95', 'opacity-0');
                setTimeout(() => {
                    themeSettings.classList.add('hidden');
                }, 300);
            });
            
            // 点击面板外部关闭
            themeSettings.addEventListener('click', (e) => {
                if (e.target === themeSettings) {
                    closeSettingsBtn.click();
                }
            });
            
            // 主题模式按钮点击事件
            lightThemeBtn.addEventListener('click', () => {
                applyTheme('light', currentColor, currentSize);
            });
            
            darkThemeBtn.addEventListener('click', () => {
                applyTheme('dark', currentColor, currentSize);
            });
            
            // 颜色选项点击事件
            colorOptions.forEach(option => {
                option.addEventListener('click', () => {
                    const color = option.getAttribute('data-color');
                    applyTheme(currentTheme, color, currentSize);
                });
            });
            
            // 界面大小按钮点击事件
            const sizeLargeBtn = document.getElementById('sizeLargeBtn');
            const sizeMediumBtn = document.getElementById('sizeMediumBtn');
            const sizeSmallBtn = document.getElementById('sizeSmallBtn');
            const sizeTinyBtn = document.getElementById('sizeTinyBtn');
            
            if (sizeLargeBtn) sizeLargeBtn.addEventListener('click', () => {
                applyTheme(currentTheme, currentColor, 'large');
            });
            
            if (sizeMediumBtn) sizeMediumBtn.addEventListener('click', () => {
                applyTheme(currentTheme, currentColor, 'medium');
            });
            
            if (sizeSmallBtn) sizeSmallBtn.addEventListener('click', () => {
                applyTheme(currentTheme, currentColor, 'small');
            });
            
            if (sizeTinyBtn) sizeTinyBtn.addEventListener('click', () => {
                applyTheme(currentTheme, currentColor, 'tiny');
            });
            
            // 滚动速度按钮点击事件
            const speedSlowBtn = document.getElementById('speedSlowBtn');
            const speedMediumBtn = document.getElementById('speedMediumBtn');
            const speedFastBtn = document.getElementById('speedFastBtn');
            
            if (speedSlowBtn) speedSlowBtn.addEventListener('click', () => {
                currentScrollSpeed = 'slow';
                updateThemeSettingsUI();
                applyTheme(currentTheme, currentColor, currentSize);
            });
            
            if (speedMediumBtn) speedMediumBtn.addEventListener('click', () => {
                currentScrollSpeed = 'medium';
                updateThemeSettingsUI();
                applyTheme(currentTheme, currentColor, currentSize);
            });
            
            if (speedFastBtn) speedFastBtn.addEventListener('click', () => {
                currentScrollSpeed = 'fast';
                updateThemeSettingsUI();
                applyTheme(currentTheme, currentColor, currentSize);
            });
            
            // 保存主题设置
            saveThemeBtn.addEventListener('click', () => {
                localStorage.setItem('preferredTheme', currentTheme);
                localStorage.setItem('preferredColor', currentColor);
                localStorage.setItem('preferredSize', currentSize);
                localStorage.setItem('preferredScrollSpeed', currentScrollSpeed);
                showNotification('主题设置已保存');
                closeSettingsBtn.click();
            });
            
            // 恢复默认主题
            resetThemeBtn.addEventListener('click', () => {
                applyTheme('light', 'red', 'small');
                showNotification('已恢复默认主题');
            });
            
            // 初始化主题设置UI
            updateThemeSettingsUI();
        }
        
        // 检查纪念日
        function checkAnniversaries() {
            const today = new Date();
            const tomorrow = new Date();
            tomorrow.setDate(today.getDate() + 1);
            
            const todayMonth = today.getMonth() + 1;
            const todayDay = today.getDate();
            const tomorrowMonth = tomorrow.getMonth() + 1;
            const tomorrowDay = tomorrow.getDate();
            
            const todayAnniversaries = [];
            const tomorrowAnniversaries = [];
            
            // 检查阳历纪念日
            anniversaryDatabase.forEach(item => {
                if (item.type === 'solar') {
                    // 检查今天
                    if (item.month === todayMonth && item.day === todayDay) {
                        todayAnniversaries.push({
                            date: `${todayMonth}月${todayDay}日`,
                            event: item.event,
                            type: 'solar'
                        });
                    }
                    
                    // 检查明天
                    if (item.month === tomorrowMonth && item.day === tomorrowDay) {
                        tomorrowAnniversaries.push({
                            date: `${tomorrowMonth}月${tomorrowDay}日`,
                            event: item.event,
                            type: 'solar'
                        });
                    }
                } else if (item.type === 'lunar') {
                    // 检查农历纪念日
                    const thisYear = today.getFullYear();
                    const solarDate = lunarToSolar(thisYear, item.month, item.day);
                    
                    // 检查今天
                    if (solarDate.month === todayMonth && solarDate.day === todayDay) {
                        todayAnniversaries.push({
                            date: `农历${item.month}月${item.day}日`,
                            event: item.event,
                            type: 'lunar'
                        });
                    }
                    
                    // 检查明天
                    if (solarDate.month === tomorrowMonth && solarDate.day === tomorrowDay) {
                        tomorrowAnniversaries.push({
                            date: `农历${item.month}月${item.day}日`,
                            event: item.event,
                            type: 'lunar'
                        });
                    }
                }
            });
            
            return {
                today: todayAnniversaries,
                tomorrow: tomorrowAnniversaries
            };
        }
        
        // 显示纪念日提醒
        function displayAnniversaryReminders() {
            const { today, tomorrow } = checkAnniversaries();
            const reminderContainer = document.getElementById('anniversaryReminders');
            
            if (!reminderContainer) return;
            
            let html = '';
            
            // 显示今天的纪念日
            if (today.length > 0) {
                html += '<div class="mb-3">';
                html += '<h3 class="text-lg font-bold text-primary mb-2 flex items-center">';
                html += '<i class="fa fa-calendar-check-o mr-2"></i> 今日纪念日';
                html += '</h3>';
                html += '<div class="bg-white bg-opacity-80 dark:bg-gray-800 dark:bg-opacity-80 rounded-lg shadow-md p-3 space-y-2">';
                
                today.forEach(item => {
                    html += '<div class="flex items-center justify-between p-2 bg-primary bg-opacity-10 rounded-lg">';
                    html += `<div class="flex items-center">`;
                    html += `<i class="fa fa-star text-primary mr-2"></i>`;
                    html += `<span class="font-medium">${item.event}</span>`;
                    html += `</div>`;
                    html += `<span class="text-sm text-gray-600 dark:text-gray-300">${item.date} (${item.type === 'solar' ? '阳历' : '农历'})</span>`;
                    html += '</div>';
                });
                
                html += '</div>';
                html += '</div>';
            }
            
            // 显示明天的纪念日
            if (tomorrow.length > 0) {
                html += '<div>';
                html += '<h3 class="text-lg font-bold text-secondary mb-2 flex items-center">';
                html += '<i class="fa fa-calendar-o mr-2"></i> 明日提醒';
                html += '</h3>';
                html += '<div class="bg-white bg-opacity-80 dark:bg-gray-800 dark:bg-opacity-80 rounded-lg shadow-md p-3 space-y-2">';
                
                tomorrow.forEach(item => {
                    html += '<div class="flex items-center justify-between p-2 bg-secondary bg-opacity-10 rounded-lg">';
                    html += `<div class="flex items-center">`;
                    html += `<i class="fa fa-clock-o text-secondary mr-2"></i>`;
                    html += `<span class="font-medium">${item.event}</span>`;
                    html += `</div>`;
                    html += `<span class="text-sm text-gray-600 dark:text-gray-300">${item.date} (${item.type === 'solar' ? '阳历' : '农历'})</span>`;
                    html += '</div>';
                });
                
                html += '</div>';
                html += '</div>';
            }
            
            // 如果没有纪念日
            if (today.length === 0 && tomorrow.length === 0) {
                html += '<div class="text-center text-gray-500 py-3">';
                html += '<i class="fa fa-info-circle mr-1"></i> 今日及明日无纪念日';
                html += '</div>';
            }
            
            reminderContainer.innerHTML = html;
            
            // 如果有今天的纪念日，显示通知
            if (today.length > 0) {
                const todayEvents = today.map(item => item.event).join('、');
                showNotification(`今日纪念日提醒：${todayEvents}`);
            }
            
            // 如果有明天的纪念日，显示通知
            if (tomorrow.length > 0) {
                const tomorrowEvents = tomorrow.map(item => item.event).join('、');
                showNotification(`明日纪念日提醒：${tomorrowEvents}`);
            }
        }
        
        // 初始化纪念日功能
        function initAnniversary() {
            // 创建纪念日提醒区域
            const container = document.createElement('div');
            container.id = 'anniversaryContainer';
            container.className = 'mb-8';
            
            container.innerHTML = `
                <div class="flex items-center justify-between items-center mb-3">
                    <h2 class="text-xl font-bold text-gray-800 flex items-center">
                        <i class="fa fa-calendar text-primary mr-2"></i> 纪念日提醒
                        <span id="anniversaryBadge" class="ml-2 bg-primary text-white text-xs px-2 py-1 rounded-full">0</span>
                    </h2>
                    <button id="toggleAnniversaryBtn" class="bg-gray-200 hover:bg-gray-300 text-dark font-medium py-1 px-3 rounded-full text-sm flex items-center">
                        <i class="fa fa-chevron-down mr-1"></i> 查看
                    </button>
                </div>
                <div id="anniversaryReminders" class="bg-white bg-opacity-80 dark:bg-gray-800 dark:bg-opacity-80 rounded-lg shadow-md p-4 hidden">
                    <!-- 纪念日提醒将通过JavaScript动态添加 -->
                </div>
            `;
            
            // 将纪念日区域插入到页面中（在搜索歌曲下面）
            const searchContainer = document.getElementById('searchResults').parentNode;
            searchContainer.parentNode.insertBefore(container, searchContainer.nextSibling);
            
            // 添加切换按钮事件
            const toggleBtn = document.getElementById('toggleAnniversaryBtn');
            const reminders = document.getElementById('anniversaryReminders');
            
            if (toggleBtn && reminders) {
                toggleBtn.addEventListener('click', () => {
                    reminders.classList.toggle('hidden');
                    
                    // 更改按钮图标和文字
                    const icon = toggleBtn.querySelector('i');
                    if (reminders.classList.contains('hidden')) {
                        icon.className = 'fa fa-chevron-down mr-1';
                        toggleBtn.innerHTML = '<i class="fa fa-chevron-down mr-1"></i> 查看';
                    } else {
                        icon.className = 'fa fa-chevron-up mr-1';
                        toggleBtn.innerHTML = '<i class="fa fa-chevron-up mr-1"></i> 收起';
                    }
                });
            }
            
            // 显示纪念日提醒
            displayAnniversaryReminders();
            
            // 更新纪念日数量徽章并控制显示/隐藏
            updateAnniversaryDisplay();
            
            // 每天凌晨自动更新纪念日
            const now = new Date();
            const hoursUntilMidnight = 24 - now.getHours();
            const minutesUntilMidnight = 60 - now.getMinutes();
            const secondsUntilMidnight = 60 - now.getSeconds();
            const msUntilMidnight = (hoursUntilMidnight * 60 * 60 + minutesUntilMidnight * 60 + secondsUntilMidnight) * 1000;
            
            // 设置定时器，每天凌晨更新一次
            setTimeout(() => {
                displayAnniversaryReminders();
                updateAnniversaryDisplay();
                
                // 之后每天更新一次
                setInterval(() => {
                    displayAnniversaryReminders();
                    updateAnniversaryDisplay();
                }, 24 * 60 * 60 * 1000);
            }, msUntilMidnight);
        }
        
        // 更新纪念日显示状态
        function updateAnniversaryDisplay() {
            const { today, tomorrow } = checkAnniversaries();
            const total = today.length + tomorrow.length;
            const container = document.getElementById('anniversaryContainer');
            const badge = document.getElementById('anniversaryBadge');
            
            if (container) {
                // 如果当天没有提示，完全隐藏纪念日提醒区域
                if (today.length === 0 && tomorrow.length === 0) {
                    container.classList.add('hidden');
                } else {
                    container.classList.remove('hidden');
                    
                    // 更新徽章
                    if (badge) {
                        badge.textContent = total;
                        
                        // 如果有纪念日，徽章闪烁提醒
                        if (total > 0) {
                            badge.classList.add('animate-pulse');
                        } else {
                            badge.classList.remove('animate-pulse');
                        }
                    }
                }
            }
        }
        
        // 谐音歌词数据库
        const lyricsDatabase = {
            "叶梓睛 - 情如风": `【山酒谐音歌词2025-11-04】
情如风 冷冷冷吹失爱 告终(亲遇风 狼狼狼催撒爱 狗总)
痛痛痛 转身是剧痛(痛痛痛 尊山西kie痛)
你我两清 不再夜夜抱拥(内哦龙亲 八zoi爷爷剖拥)
难忘从前和你热吻(男猛从轻窝内溢满)
然而离场时却被困(音译雷琼洗可被宽)
沿途缠绵谁最吸引(晕头亲民随最卡阳)
念念最深(宁宁最三)
遗忘从前谁最合衬(外蒙从轻岁最哈惨)
弥留余情如风在渗(没老玉琴玉凤zoi三)
爱过痛过 似风走过(爱过痛过 起风早过)
别认真(比延赞)
******
情如风 冷冷冷吹失爱 告终(亲遇风 狼狼狼催撒爱 狗总)
痛痛痛 转身是剧痛(痛痛痛 尊山西kie痛)
你我两清 不再夜夜抱拥(内哦龙亲 八zoi爷爷剖拥)
情如风 你远去仿佛似 冷冬(亲遇风 内晕黑风发起 兰东)
爱爱爱 心底渐渐冻(爱爱爱 三代仅仅冻)
你已散失风里 在日后梦中相送(内衣三撒风loi zoi呀好梦中熊送)
难忘从前和你热吻(男猛从轻窝内溢满)
然而离场时却被困(音译雷琼洗可被宽)
沿途缠绵谁最吸引(晕头亲民随最卡阳)
念念最深(宁宁最三)
遗忘从前谁最合衬(外蒙从轻岁最哈惨)
弥留余情如风在渗(没老玉琴玉凤zoi三)
爱过痛过 似风走过(爱过痛过 起风早过)
别认真(比延赞)
******
情如风 冷冷冷吹失爱 告终(亲遇风 狼狼狼催撒爱 狗总)
痛痛痛 转身是剧痛(痛痛痛 尊山西kie痛)
你我两清 不再夜夜抱拥(内哦龙亲 八zoi爷爷剖拥)
情如风 你远去仿佛似 冷冬(亲遇风 内晕黑风发起 兰东)
爱爱爱 心底渐渐冻(爱爱爱 三代仅仅冻)
你已散失风里 在日后梦中相送(内衣三撒风loi zoi呀好梦中熊送)
******
情如风 冷冷冷吹失爱 告终(亲遇风 狼狼狼催撒爱 狗总)
痛痛痛 转身是剧痛(痛痛痛 尊山西kie痛)
你我两清 不再夜夜抱拥(内哦龙亲 八zoi爷爷剖拥)
情如风 你远去仿佛似 冷冬(亲遇风 内晕黑风发起 兰东)
爱爱爱 心底渐渐冻(爱爱爱 三代仅仅冻)
你已散失风里 在日后梦中相送(内衣三撒风loi zoi呀好梦中熊送)`,
            
            "周慧敏 - 最爱": `【山酒谐音歌词2024-08-10】
（听红呀平外蓝）天空一片蔚蓝
（清风添熊流龙满）清风添上了浪漫
（森类那凡要琴马一启会某汉）心里那份柔情蜜意似海无限
（在那要云瑶一某一遇熊）在那遥远有意无意遇上
（弓内磋期嗨好水木瑶哈熊）共你初次邂逅谁没有遐想
（系呀本得落哈）诗一般的落霞
（走呀本得几用）酒一般的夕阳
（气系与楼卡内哦老羊囧）似是月老给你我留印象
（且用类黑朗与已问熊）斜阳离去朗月已换上
（木法音开结犯情哟改泪囧）没法掩盖这份情欲盖弭彰
（结呀洒，情呀老）这一刹，情一缕
（影呀对，羊压熊）影一对，人一双
（那怕意气爱呀穷）那怕热炽爱一场
（求几退我囧）潮汐退和涨
（与朗疯我熊）月冷风和霜
（夜雨得狂熊）夜雨的狂想
（野发得没哼）野花的微香
（本哦星爷类玩熊）伴我星夜里幻想
 (疯几八用太敢囧）方知不用太紧张
（木法洋葱结帆爱）没法隐藏这份爱
 (系哦桑请桑气海）是我深情深似海
（压山压塞难反黑)一生一世难分开
(难改宾呀难在）难改变也难再 
（用内得爱门三耐）让你的爱满心内
******
（在那要云瑶一某一遇熊）在那遥远有意无意遇上
（弓内磋期嗨好水木瑶哈熊）共你初次邂逅谁没有遐想
（系呀本得落哈）诗一般的落霞
（走呀本得几用）酒一般的夕阳
（气系与楼卡内哦老羊囧）似是月老给你我留印象
（且用类黑朗与已问熊）斜阳离去朗月已换上
（木法音开结犯情哟改泪囧）没法掩盖这份情欲盖弭彰
（结呀洒，情呀老）这一刹，情一缕
（影呀对，羊压熊）影一对，人一双
（那怕意气爱呀穷）那怕热炽爱一场
（求几退我囧）潮汐退和涨
（与朗疯我熊）月冷风和霜
（夜雨得狂熊）夜雨的狂想
（野发得没哼）野花的微香
（本哦星爷类玩熊）伴我星夜里幻想
 (疯几八用太敢囧）方知不用太紧张
（木法洋葱结帆爱）没法隐藏这份爱
 (系哦桑请桑气海）是我深情深似海
（压山压塞难反黑)一生一世难分开
(难改宾呀难在）难改变也难再
（用内得爱门三耐）让你的爱满心内
******
（求几退我囧）潮汐退和涨
（与朗疯我熊）月冷风和霜
（夜雨得狂熊）夜雨的狂想
（野发得没哼）野花的微香
（本哦星爷类玩熊）伴我星夜里幻想
 (疯几八用太敢囧）方知不用太紧张
（木法洋葱结帆爱）没法隐藏这份爱
 (系哦桑请桑气海）是我深情深似海
（压山压塞难反黑)一生一世难分开
(难改宾呀难在）难改变也难再
（用内得爱门三耐）让你的爱满心内
（羊哦得爱群卡内）让我的爱全给你
（群卡哦最爱）全给我最爱
（得楼听方影没改）地老天荒仍未改`,
            
            "草蜢 - 半点心 (Remix)(DJ阿福版)": `【山酒谐音歌词2024-01-08】
我说这里好吗（哦需街垒猴妈）
你抬头而无话（内腿套一某哇）
你抱我吻上我嘴巴（内剖哦满胸哦嘴巴）
却似你吻向他（可期内满哼他）
我暗中想总有一点爱吧（哦暗中兄总咬压顶爱吧）
可以交给我吧（后裔高卡哦吧）
总算得恋爱吧（总寻答论爱吧）
相爱少点也罢（兄爱修订压吧）
我却更了解是（哦可敢留该系）
编织梦话（拼接萌挖）
半点心（本定三）
请交给我不过是个小小愿望吧（请高卡哦八国洗过秀秀云梦吧）
你的心（内得三）
却一早已整个完完全全交给他（可以走已建过云云群群高卡他）
******
怕说到你跟他（怕需都内干他）
我说无穷傻话（哦需某空索瓦）
你听了永远笑哈哈（内听六翁云秀哈哈）
我更言而无话（哦刚音译某哇）
你我之间总有一点爱吧（内哦鸡肝总要压顶爱吧）
可以交给我吧（后裔高卡哦吧）
总算得恋爱吧（总寻答论爱吧）
相爱少点也罢（兄爱修订压吧）
我却更了解是（哦可敢留该系）
编织梦话（拼接萌挖）
半点心（本定三）
请交给我不过是个小小愿望吧（请高卡哦八国洗过秀秀云梦吧）
你的心（内得三）
却一早已整个完完全全交给他（可以走已建过云云群群高卡他）
******
说过爱要潇洒（需过爱要修撒）
错爱了回头吧（错爱六维涛吧）
到这晚却说半点心（都接满可需本定三）
仍然求能留下（烟瘾靠南老哈）
你我之间总有一点爱吧（内哦鸡肝总要压顶爱吧）
可以交给我吧（后裔高卡哦吧）
总算得恋爱吧（总寻答论爱吧）
相爱少点也罢（兄爱修订压吧）
我却更了解是（哦可敢留该系）
编织梦话（拼接萌挖）
半点心（本定三）
请交给我不过是个小小愿望吧（请高卡哦八国洗过秀秀云梦吧）
你的心（内得三）
却一早已整个完完全全交给他（可以走已建过云云群群高卡他）
他跟你好吗（他敢内猴妈）
一切的爱怎么都送给他（芽菜得爱咱么都送卡他）
一颗心分一半好吗（压佛三番压本猴妈）
起码一半都交给我好吗（黑马压本都高卡哦猴妈）
给我吗（卡哦吗）`,
            
            "倾丢丢 - 孤单夜莺DJ": `【山酒谐音歌词2023-08-09】
谁难在解哈剖剖哦木谷类 (谁能在这刻抱抱我没顾虑)
夜夜爱过 七佛(夜夜爱歌似火)
退哈三喜众多 (台下绅士众多)
哦得乎卡修一朵 绝魔(我的呼吸烧耳朵着魔)
每类高说 干果(魅力教唆禁果)
狂一黑粉哦莫 (狂热喜欢我么)
但哦三七总红座 (但我心始终空座)
穷套爱过 给过(唱透爱歌结果)
某耐三番凶锁 (无奈身份上锁)
烙印菲菲爸要扣改哦 (流言蜚蜚不休曲解我)
哦爱音佛 谈过(我爱烟火探戈)
但哦八岁切萝 (但我不需赤裸)
陪滚吧喊多风波 (疲倦不堪多风波)
******
晕爱但怕 负累(愿爱但怕负累)
听音马玉木要 谁罪(甜言蜜语没有死罪)
雨后南玻打羊黑 (如何能博得恩许)
南雄论八歪给 (能相恋不畏惧)
谁难在解哈剖剖哦木谷类 (谁能在这刻抱抱我没顾虑)
谁难在某台慢慢哦得俺累 (谁能在舞台吻吻我的眼泪)
谁民吧行泪过囧沸水三月肺黑 (谁明白圣女歌像沸水心若废墟)
做黑多修干亏 (筑起多少禁区)
谁难呀哦三爱爱哦木咬嘴 (谁能入我心爱爱我没有罪)
谁难在嗯也giugiu哦应走水 (谁能在午夜叫叫我应早睡)
巫妖哦吧在烂醉玩轮也累 (护佑我不再烂醉温暖夜里)
龙慢逗逼吹吹 (浪漫道别徐徐)
******
晕爱但怕 负累(愿爱但怕负累)
听音马玉木要 谁罪(甜言蜜语没有死罪)
雨后南玻打羊黑 (如何能博得恩许)
南雄论八歪给 (能相恋不畏惧)
谁难在解哈剖剖哦木谷类 (谁能在这刻抱抱我没顾虑)
谁难在某台慢慢哦得俺累 (谁能在舞台吻吻我的眼泪)
谁民吧行泪过囧沸水三月肺黑 (谁明白圣女歌像沸水心若废墟)
做黑多修干亏 (筑起多少禁区)
谁难呀哦三爱爱哦木咬嘴 (谁能入我心爱爱我没有罪)
谁难在嗯也giugiu哦应走水 (谁能在午夜叫叫我应早睡)
巫妖哦吧在烂醉玩轮也累 (护佑我不再烂醉温暖夜里)
龙慢逗逼吹吹 (浪漫道别徐徐)
******
谁难在解哈剖剖哦谷类 (谁能在这刻抱抱我没顾虑)
谁难在某台慢慢哦得俺累 (谁能在舞台吻吻我的眼泪)
谁民吧行泪过囧沸水三月肺黑 (谁明白圣女歌像沸水心若废墟)
做黑多修干亏 (筑起多少禁区)
谁难呀哦三爱爱哦木咬嘴 (谁能入我心爱爱我没有罪)
谁难在嗯也giugiu哦应走水 (谁能在午夜叫叫我应早睡)
巫妖哦吧在烂醉玩轮也累 (护佑我不再烂醉温暖夜里)
龙慢逗逼吹吹 (浪漫道别徐徐)`,
            
            "王晴 - 留什么给你 (国粤语版)": `【山酒谐音歌词2023-06-14】
粤语：
木筏黑压水爱爱梦穷斌雨水(没法去入睡呆呆望窗边雨水)
嘻嘻得休渔顶顶得药类(丝丝的小雨点点的忧虑)
囧重重论谁(像重重乱絮)
国语：
圆满的结局终究可望不可及
感情要休息流浪要勇气还想不想你
粤语：
七七得罪靠孙咱得爱文本吹(痴痴的追求纯真的爱永伴随)
服服得爱靠类海得内爱哈黑(苦苦的哀求离开的你爱下去)
国语：
让不很在乎寂寞的我难过得想哭泣
粤语：
南都内气宗都拆八套气宗都才把对(难道你始终都猜不透始终都猜不对)
最爱内吸水(最爱你是谁)
领哦套套得些俺累套套得蛋内(令我 偷偷的拭眼泪偷偷的等你)
逃散得系岁(偷心的是谁)
国语：
可是我不停泊的行李不确定的轨迹
明天会在哪里
而我还有什么能够留给你
歌名：留什么给你 (国粤语版) - 王晴
粤语：
木筏黑压水爱爱梦穷斌雨水(没法去入睡呆呆望窗边雨水)
嘻嘻得休渔顶顶得药类(丝丝的小雨点点的忧虑)
囧重重论谁(像重重乱絮)
国语：
圆满的结局终究可望不可及
感情要休息流浪要勇气还想不想你
粤语：
七七得罪靠孙咱得爱文本吹(痴痴的追求纯真的爱永伴随)
服服得爱靠类海得内爱哈黑(苦苦的哀求离开的你爱下去)
国语：
让不很在乎寂寞的我难过得想哭泣
粤语：
南都内气宗都拆八套气宗都才把对(难道你始终都猜不透始终都猜不对)
最爱内吸水(最爱你是谁)
领哦套套得些俺累套套得蛋内(令我 偷偷的拭眼泪偷偷的等你)
逃散得系岁(偷心的是谁)
国语：
可是我不停泊的行李不确定的轨迹
明天会在哪里
而我还有什么能够留给你`,
            
            "兰姗姗、郑添媛 - 真的爱着你": `【山酒谐音歌词2023-05-18】
斗鸡红蛋哦怕内为八级(独自空等我怕你会不知)
劫犯爱多么熊购机内(这份爱多么想告知你)
K撒哦呀三级爱内压羊(其实我一生只爱你一人)
眼运移其三外内蛋(仍愿意痴心为你等)
早在雨夜内求求得早过(就在雨夜你悄悄的走过)
一斤给错论类哦得三(已占据初恋里我的心)
应梦内干听早都哦三盆(凝望你今天走到我身旁)
来用哦共呀星I love you(来让我讲一声I love you)
狼与求求挺拔(冷雨悄悄停吧)
挺赞得三羊外内(天真的心因为你)
那滚多风雨听眼我内牙黑(哪管多风雨天仍和你一起)
狗搜内哦K撒多么得熊内(告诉你我其实多么的想你)
K撒哦哦咱得爱着内(其实我我真的爱着你)
******
斗鸡红蛋哦怕内为八级(独自空等我怕你会不知)
劫犯爱多么熊购机内(这份爱多么想告知你)
K撒哦呀三级爱内压羊(其实我一生只爱你一人)
眼运移其三外内蛋(仍愿意痴心为你等)
早在雨夜内求求得早过(就在雨夜你悄悄的走过)
一斤给错论类哦得三(已占据初恋里我的心)
应梦内干听早都哦三盆(凝望你今天走到我身旁)
来用哦共呀星I love you(来让我讲一声I love you)
狼与求求挺拔(冷雨悄悄停吧)
挺赞得三羊外内(天真的心因为你)
那滚多风雨听眼我内牙黑(哪管多风雨天仍和你一起)
狗搜内哦K撒多么得熊内(告诉你我其实多么的想你)
K撒哦哦咱得爱着内(其实我我真的爱着你)
多么熊囧三类需哇购机内(多么想将心里说话告知你)
狗搜内爱惜木筏头被(告诉你爱是没法逃避)
蛋外靠普本内(但为求陪伴你)
哦呀三及熊宇内牙黑(我一生只想与你一起)
狼与求求挺拔(冷雨悄悄停吧)
挺赞得三羊外内(天真的心因为你)
那滚多风雨听眼我内牙黑(哪管多风雨天仍和你一起)
狗搜内哦K撒多么得熊内(告诉你我其实多么的想你)
K撒哦哦咱得爱着内(其实我我真的爱着你)
K撒哦哦多么爱内(其实我我多么爱你)`,
            
            "蓝兰 - 晚风1997": `【山酒谐音歌词2022-07-28】
(城市尽头)
(引路灯靠在黄昏的肩头)
(散步街口)
(爱人温柔相拥)
(风也说它)
(会在悄悄吹进谁的心海)
(是你回眸点星光走来)
(我的心动因为你盛开)
(因为有你才能圆满)
(你的笑容摇曳在空中晕开)
(我心跳又慢了几拍)
同内共豆美满(同你共渡每晚)
重启八再孤单(从此不再孤单)
尅啥要内熊本届压山(其实有你相伴这一生)
呀做高龙忙(也足够浪漫)
遇三带富雯(于心底呼唤)
要内八再孤单(有你不再孤单)
从解哈美方没缪(从这刻每分每秒)
赔本内问秀用灿烂(陪伴你换笑容灿烂)
******
(城市尽头)
(引路灯靠在黄昏的肩头)
(散步街口)
(爱人温柔相拥)
(风也说它)
(会在悄悄吹进谁的心海)
(是你回眸点星光走来)
(我的心动因为你盛开)
(因为有你才能圆满)
(你的笑容摇曳在空中晕开)
(我心跳又慢了几拍)
同内共豆美满(同你共渡每晚)
重启八再孤单(从此不再孤单)
尅啥要内熊本届压山(其实有你相伴这一生)
呀做高龙忙(也足够浪漫)
遇三带富雯(于心底呼唤)
要内八再孤单(有你不再孤单)
从解哈美方没缪(从这刻每分每秒)
赔本内问秀用灿烂(陪伴你换笑容灿烂)
同内共都美满(同你共渡每晚)
重启八再孤单(从此不再孤单)
尅啥要内熊本届压山(其实有你相伴这一生)
呀做高龙忙(也足够浪漫)
遇三带富雯(于心底呼唤)
要内八再孤单(有你不再孤单)
从解哈美方没缪(从这刻每分每秒)
赔本内问秀用灿烂(陪伴你换笑容灿烂)`,
            
            "王大毛 - 今晚不想睡": `【网络搜索谐音歌词】
抹狼李菜，挖kia耶泼蓝哦偷败，
无洗挺沁，无洗轰，无洗咯吼梯。 
抹狼撩改，并又啊，腻嘎tia污抹，
哇乙ging呱顶最给无gi起诶勺年ki。`
        };
        
        // 全局变量 - 字体大小按钮
        let fontSizeSmallBtn, fontSizeMediumBtn, fontSizeLargeBtn;
        
        // 初始化谐音歌词功能
        function initLyricsSearch() {
            // 创建谐音歌词区域
            const lyricsContainer = document.createElement('div');
            lyricsContainer.id = 'lyricsContainer';
            lyricsContainer.className = 'mt-12 p-6 border-t border-gray-200 dark:border-gray-700';
            
            lyricsContainer.innerHTML = `
                <div class="text-center mb-8">
                    <h2 class="text-3xl font-bold text-primary mb-2">谐音歌词搜索</h2>
                    <p class="text-gray-600 dark:text-gray-400"><i class="fa fa-info-circle mr-2"></i>点击"查看"按钮显示歌名列表，点击"展开"按钮查看谐音歌词</p>
                </div>
                
                <div class="flex justify-center mb-8">
                    <button id="viewLyricsBtn" class="bg-primary hover:bg-red-600 text-white font-bold py-3 px-8 rounded-full shadow-lg btn-pop flex items-center">
                        <i class="fa fa-list mr-2"></i> 查看
                    </button>
                </div>
                
                <div id="songListContainer" class="hidden mb-8">
                    <h3 class="text-xl font-bold text-gray-800 dark:text-gray-200 mb-4">谐音歌词列表</h3>
                    <div id="songList" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <!-- 歌曲列表将通过JavaScript动态添加 -->
                    </div>
                </div>
                
                <div id="lyricsDisplayContainer" class="hidden">
                    <div class="flex justify-between items-center mb-4">
                        <h3 id="currentSongTitle" class="text-xl font-bold text-primary"></h3>
                        <div class="flex gap-2">
                            <button id="closeLyricsBtn" class="bg-gray-200 hover:bg-gray-300 text-gray-700 py-1 px-3 rounded-full text-sm flex items-center">
                                <i class="fa fa-times mr-1"></i> 关闭
                            </button>
                        </div>
                    </div>
                    
                    <div class="flex justify-center gap-4 mb-4">
                        <button id="fontSizeSmallBtn" class="bg-gray-200 hover:bg-gray-300 text-gray-700 py-1 px-3 rounded-full text-sm flex items-center">
                            <i class="fa fa-font text-xs mr-1"></i> 小
                        </button>
                        <button id="fontSizeMediumBtn" class="bg-gray-200 hover:bg-gray-300 text-gray-700 py-1 px-3 rounded-full text-sm flex items-center ring-2 ring-primary">
                            <i class="fa fa-font mr-1"></i> 中
                        </button>
                        <button id="fontSizeLargeBtn" class="bg-gray-200 hover:bg-gray-300 text-gray-700 py-1 px-3 rounded-full text-sm flex items-center">
                            <i class="fa fa-font text-lg mr-1"></i> 大
                        </button>
                    </div>
                    
                    <div id="lyricsContent" class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 font-mono text-sm max-h-96 overflow-y-auto whitespace-pre-wrap">
                        <!-- 歌词将通过JavaScript动态添加 -->
                    </div>
                </div>
            `;
            
            // 将谐音歌词区域添加到页面底部
            document.body.appendChild(lyricsContainer);
            
            // 获取DOM元素
            const viewLyricsBtn = document.getElementById('viewLyricsBtn');
            const songListContainer = document.getElementById('songListContainer');
            const songList = document.getElementById('songList');
            const lyricsDisplayContainer = document.getElementById('lyricsDisplayContainer');
            const currentSongTitle = document.getElementById('currentSongTitle');
            const lyricsContent = document.getElementById('lyricsContent');
            const closeLyricsBtn = document.getElementById('closeLyricsBtn');
            
            // 初始化全局字体大小按钮变量
            fontSizeSmallBtn = document.getElementById('fontSizeSmallBtn');
            fontSizeMediumBtn = document.getElementById('fontSizeMediumBtn');
            fontSizeLargeBtn = document.getElementById('fontSizeLargeBtn');
            
            // 查看/收起按钮点击事件
            viewLyricsBtn.addEventListener('click', () => {
                // 切换按钮文本和图标
                const icon = viewLyricsBtn.querySelector('i');
                if (viewLyricsBtn.textContent.includes('查看')) {
                    // 查看状态：显示歌曲列表
                    viewLyricsBtn.innerHTML = '<i class="fa fa-chevron-up mr-2"></i> 收起';
                    songListContainer.classList.remove('hidden');
                    generateSongList();
                    lyricsDisplayContainer.classList.add('hidden');
                } else {
                    // 收起状态：隐藏所有内容
                    viewLyricsBtn.innerHTML = '<i class="fa fa-list mr-2"></i> 查看';
                    songListContainer.classList.add('hidden');
                    lyricsDisplayContainer.classList.add('hidden');
                }
            });
            
            // 关闭按钮点击事件
            closeLyricsBtn.addEventListener('click', () => {
                // 隐藏歌词显示区域
                lyricsDisplayContainer.classList.add('hidden');
                
                // 显示歌曲列表
                songListContainer.classList.remove('hidden');
                
                // 保持查看按钮为收起状态
                viewLyricsBtn.innerHTML = '<i class="fa fa-chevron-up mr-2"></i> 收起';
            });
            
            // 字体大小按钮点击事件
            fontSizeSmallBtn.addEventListener('click', () => {
                setLyricsFontSize('small');
                updateFontSizeButtons('small');
            });
            
            fontSizeMediumBtn.addEventListener('click', () => {
                setLyricsFontSize('medium');
                updateFontSizeButtons('medium');
            });
            
            fontSizeLargeBtn.addEventListener('click', () => {
                setLyricsFontSize('large');
                updateFontSizeButtons('large');
            });
            
            // 生成歌曲列表
            function generateSongList() {
                if (!songList) return;
                
                // 清空现有内容
                songList.innerHTML = '';
                
                // 获取所有歌曲名
                const songTitles = Object.keys(lyricsDatabase);
                
                // 创建歌曲列表项
                songTitles.forEach(title => {
                    const songItem = document.createElement('div');
                    songItem.className = 'bg-white dark:bg-gray-800 rounded-lg shadow-md p-4 flex justify-between items-center';
                    
                    songItem.innerHTML = `
                        <span class="text-gray-800 dark:text-gray-200">${title}</span>
                        <button class="expand-lyrics-btn bg-secondary hover:bg-blue-600 text-white py-1 px-3 rounded-full text-sm flex items-center" data-song="${title}">
                            <i class="fa fa-chevron-down mr-1"></i> 展开
                        </button>
                    `;
                    
                    songList.appendChild(songItem);
                    
                    // 添加展开按钮事件
                    const expandBtn = songItem.querySelector('.expand-lyrics-btn');
                    expandBtn.addEventListener('click', (e) => {
                        const songTitle = e.currentTarget.getAttribute('data-song');
                        displayLyrics(songTitle);
                    });
                });
            }
            
            // 显示歌词
            function displayLyrics(songTitle) {
                if (!lyricsDatabase[songTitle]) return;
                
                // 设置当前歌曲标题
                currentSongTitle.textContent = songTitle;
                
                // 设置歌词内容
                lyricsContent.textContent = lyricsDatabase[songTitle];
                
                // 隐藏歌曲列表
                songListContainer.classList.add('hidden');
                
                // 显示歌词显示区域
                lyricsDisplayContainer.classList.remove('hidden');
                
                // 更新查看按钮为收起状态
                viewLyricsBtn.innerHTML = '<i class="fa fa-chevron-up mr-2"></i> 收起';
                
                // 重置字体大小为默认
                setLyricsFontSize('medium');
                updateFontSizeButtons('medium');
            }
            
            // 设置歌词字体大小和行高
            function setLyricsFontSize(size) {
                if (!lyricsContent) return;
                
                // 获取当前界面大小系数
                const baseSize = parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--base-size')) || 1;
                
                if (size === 'small') {
                    lyricsContent.style.fontSize = (14 * baseSize) + 'px';
                    lyricsContent.style.lineHeight = (20 * baseSize) + 'px';
                } else if (size === 'medium') {
                    lyricsContent.style.fontSize = (18 * baseSize) + 'px';
                    lyricsContent.style.lineHeight = (26 * baseSize) + 'px';
                } else if (size === 'large') {
                    lyricsContent.style.fontSize = (22 * baseSize) + 'px';
                    lyricsContent.style.lineHeight = (32 * baseSize) + 'px';
                }
            }
            
            // 更新字体大小按钮状态
            function updateFontSizeButtons(activeSize) {
                // 移除所有按钮的选中状态
                fontSizeSmallBtn.classList.remove('ring-2', 'ring-primary');
                fontSizeMediumBtn.classList.remove('ring-2', 'ring-primary');
                fontSizeLargeBtn.classList.remove('ring-2', 'ring-primary');
                
                // 添加当前选中按钮的状态
                if (activeSize === 'small') {
                    fontSizeSmallBtn.classList.add('ring-2', 'ring-primary');
                } else if (activeSize === 'medium') {
                    fontSizeMediumBtn.classList.add('ring-2', 'ring-primary');
                } else if (activeSize === 'large') {
                    fontSizeLargeBtn.classList.add('ring-2', 'ring-primary');
                }
            }
        }
        
        // 页面加载完成后初始化
        document.addEventListener('DOMContentLoaded', () => {
            init();
            initSearch();
            initHistory();
            initTheme();
            initThemeSettings();
            initAnniversary();
            initLyricsSearch();
            
            // 监听界面大小变化，更新歌词显示
            const observer = new MutationObserver((mutations) => {
                mutations.forEach((mutation) => {
                    if (mutation.attributeName === 'style') {
                        // 确保字体大小按钮已初始化
                        if (fontSizeSmallBtn && fontSizeMediumBtn && fontSizeLargeBtn) {
                            // 获取当前选中的字体大小
                            let activeSize = 'medium';
                            if (fontSizeSmallBtn.classList.contains('ring-2')) {
                                activeSize = 'small';
                            } else if (fontSizeLargeBtn.classList.contains('ring-2')) {
                                activeSize = 'large';
                            }
                            
                            // 更新歌词字体大小和行高
                            setLyricsFontSize(activeSize);
                        }
                    }
                });
            });
            
            // 观察根元素的style变化
            observer.observe(document.documentElement, { attributes: true });
        });
    </script>
</body>
</html>
